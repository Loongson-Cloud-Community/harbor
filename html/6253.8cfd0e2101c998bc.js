"use strict";(self.webpackChunkharbor_portal=self.webpackChunkharbor_portal||[]).push([[6253],{4296:(I,x,c)=>{c.d(x,{k:()=>e});var p=c(9862),f=c(3586),v=c(2181),C=c(7398),E=c(5879),y=c(9462);let e=(()=>{var h;class Z extends f.b{constructor(s,a){super(s,a)}listRegistryProviderTypesResponse(s){let a=this.newParams(),l=new p.WM;null!=s&&(l=l.set("X-Request-Id",s.toString()));let P=new p.aW("GET",this.rootUrl+"/replication/adapters",null,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}listRegistryProviderTypes(s){return this.listRegistryProviderTypesResponse(s).pipe((0,C.U)(a=>a.body))}listRegistryProviderInfosResponse(s){let a=this.newParams(),l=new p.WM;null!=s&&(l=l.set("X-Request-Id",s.toString()));let P=new p.aW("GET",this.rootUrl+"/replication/adapterinfos",null,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}listRegistryProviderInfos(s){return this.listRegistryProviderInfosResponse(s).pipe((0,C.U)(a=>a.body))}createRegistryResponse(s){let a=this.newParams(),l=new p.WM,g=null;g=s.registry,null!=s.XRequestId&&(l=l.set("X-Request-Id",s.XRequestId.toString()));let P=new p.aW("POST",this.rootUrl+"/registries",g,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}createRegistry(s){return this.createRegistryResponse(s).pipe((0,C.U)(a=>a.body))}listRegistriesResponse(s){let a=this.newParams(),l=new p.WM;null!=s.sort&&(a=a.set("sort",s.sort.toString())),null!=s.q&&(a=a.set("q",s.q.toString())),null!=s.pageSize&&(a=a.set("page_size",s.pageSize.toString())),null!=s.page&&(a=a.set("page",s.page.toString())),null!=s.name&&(a=a.set("name",s.name.toString())),null!=s.XRequestId&&(l=l.set("X-Request-Id",s.XRequestId.toString()));let P=new p.aW("GET",this.rootUrl+"/registries",null,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}listRegistries(s){return this.listRegistriesResponse(s).pipe((0,C.U)(a=>a.body))}pingRegistryResponse(s){let a=this.newParams(),l=new p.WM,g=null;g=s.registry,null!=s.XRequestId&&(l=l.set("X-Request-Id",s.XRequestId.toString()));let P=new p.aW("POST",this.rootUrl+"/registries/ping",g,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}pingRegistry(s){return this.pingRegistryResponse(s).pipe((0,C.U)(a=>a.body))}getRegistryResponse(s){let a=this.newParams(),l=new p.WM;null!=s.XRequestId&&(l=l.set("X-Request-Id",s.XRequestId.toString()));let P=new p.aW("GET",this.rootUrl+`/registries/${s.id}`,null,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}getRegistry(s){return this.getRegistryResponse(s).pipe((0,C.U)(a=>a.body))}deleteRegistryResponse(s){let a=this.newParams(),l=new p.WM;null!=s.XRequestId&&(l=l.set("X-Request-Id",s.XRequestId.toString()));let P=new p.aW("DELETE",this.rootUrl+`/registries/${s.id}`,null,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}deleteRegistry(s){return this.deleteRegistryResponse(s).pipe((0,C.U)(a=>a.body))}updateRegistryResponse(s){let a=this.newParams(),l=new p.WM,g=null;g=s.registry,null!=s.XRequestId&&(l=l.set("X-Request-Id",s.XRequestId.toString()));let P=new p.aW("PUT",this.rootUrl+`/registries/${s.id}`,g,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}updateRegistry(s){return this.updateRegistryResponse(s).pipe((0,C.U)(a=>a.body))}getRegistryInfoResponse(s){let a=this.newParams(),l=new p.WM;null!=s.XRequestId&&(l=l.set("X-Request-Id",s.XRequestId.toString()));let P=new p.aW("GET",this.rootUrl+`/registries/${s.id}/info`,null,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}getRegistryInfo(s){return this.getRegistryInfoResponse(s).pipe((0,C.U)(a=>a.body))}}return(h=Z).listRegistryProviderTypesPath="/replication/adapters",h.listRegistryProviderInfosPath="/replication/adapterinfos",h.createRegistryPath="/registries",h.listRegistriesPath="/registries",h.pingRegistryPath="/registries/ping",h.getRegistryPath="/registries/{id}",h.deleteRegistryPath="/registries/{id}",h.updateRegistryPath="/registries/{id}",h.getRegistryInfoPath="/registries/{id}/info",h.\u0275fac=function(s){return new(s||h)(E.LFG(y.p),E.LFG(p.eN))},h.\u0275prov=E.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),Z})()},69:(I,x,c)=>{c.d(x,{B:()=>e});var p=c(9862),f=c(3586),v=c(2181),C=c(7398),E=c(5879),y=c(9462);let e=(()=>{var h;class Z extends f.b{constructor(s,a){super(s,a)}getStatisticResponse(s){let a=this.newParams(),l=new p.WM;null!=s&&(l=l.set("X-Request-Id",s.toString()));let P=new p.aW("GET",this.rootUrl+"/statistics",null,{headers:l,params:a,responseType:"json"});return this.http.request(P).pipe((0,v.h)(_=>_ instanceof p.Zn),(0,C.U)(_=>_))}getStatistic(s){return this.getStatisticResponse(s).pipe((0,C.U)(a=>a.body))}}return(h=Z).getStatisticPath="/statistics",h.\u0275fac=function(s){return new(s||h)(E.LFG(y.p),E.LFG(p.eN))},h.\u0275prov=E.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),Z})()},6253:(I,x,c)=>{c.r(x),c.d(x,{ProjectsModule:()=>ke});var p=c(4554),f=c(7398),v=c(3620),C=c(3997),E=c(2181),y=c(4664),e=c(5879),h=c(6223),Z=c(9315),T=c(2438);class s{constructor(){this.metadata={},this.metadata.public=!1}}var a=c(27),l=c(1691),g=c(208),P=c(5738),_=c(9515),R=c(3419),z=c(4296),m=c(8280),j=c(6814),M=c(2787);const H=["projectForm"],W=["projectName"];function k(i,u){if(1&i&&(e.TgZ(0,"clr-control-error",29)(1,"span",30),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const r=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,r.nameTooltipText))}}function K(i,u){1&i&&(e.TgZ(0,"clr-tooltip-content",31)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"PROJECT.INLINE_HELP_PUBLIC")))}function $(i,u){1&i&&(e.TgZ(0,"clr-tooltip-content",31)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"PROJECT.QUOTA_UNLIMIT_TIP")))}function ee(i,u){if(1&i&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&i){const r=e.oxw().$implicit;e.Q6J("value",r.UNIT),e.xp6(1),e.hij(" ",r.UNIT," ")}}function te(i,u){1&i&&e.YNc(0,ee,2,2,"option",38),2&i&&e.Q6J("ngIf",u.index>1)}function ne(i,u){1&i&&(e.TgZ(0,"clr-control-error",29),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"PROJECT.STORAGE_QUOTA_TIP")," "))}function ie(i,u){if(1&i){const r=e.EpF();e.TgZ(0,"div",5)(1,"label",32),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"clr-tooltip"),e._UZ(5,"clr-icon",15),e.YNc(6,$,4,3,"clr-tooltip-content",16),e.qZA()(),e.TgZ(7,"div",7)(8,"input",33,34),e.NdJ("ngModelChange",function(n){e.CHM(r);const o=e.oxw();return e.KtG(o.storageLimit=n)}),e.qZA(),e._UZ(10,"clr-icon",11),e.TgZ(11,"div",35)(12,"select",36),e.NdJ("ngModelChange",function(n){e.CHM(r);const o=e.oxw();return e.KtG(o.storageLimitUnit=n)}),e.YNc(13,te,1,1,"ng-template",37),e.qZA()(),e.YNc(14,ne,3,3,"clr-control-error",13),e.qZA()()}if(2&i){const r=e.MAs(9),t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,7,"PROJECT.STORAGE_QUOTA")," "),e.xp6(5),e.ekj("clr-error",r.invalid&&(r.dirty||r.touched)||r.errors),e.xp6(1),e.Q6J("ngModel",t.storageLimit),e.xp6(4),e.Q6J("ngModel",t.storageLimitUnit),e.xp6(1),e.Q6J("ngForOf",t.quotaUnits),e.xp6(1),e.Q6J("ngIf",r.invalid&&(r.dirty||r.touched)||r.errors)}}function re(i,u){1&i&&(e.TgZ(0,"clr-tooltip-content",31)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"PROJECT.PROXY_CACHE_TOOLTIP")))}function oe(i,u){if(1&i&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&i){const r=u.$implicit;e.Q6J("value",r.id),e.xp6(1),e.AsE(" ",r.name,"-",r.url," ")}}function se(i,u){if(1&i){const r=e.EpF();e.TgZ(0,"div",43)(1,"select",44),e.NdJ("ngModelChange",function(n){e.CHM(r);const o=e.oxw(2);return e.KtG(o.project.registry_id=n)}),e._UZ(2,"option",45),e.YNc(3,oe,2,3,"option",46),e.qZA()()}if(2&i){const r=e.oxw(2);e.xp6(1),e.Q6J("ngModel",r.project.registry_id),e.xp6(2),e.Q6J("ngForOf",r.registries)}}function le(i,u){if(1&i){const r=e.EpF();e.TgZ(0,"div",5)(1,"label",20),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"clr-tooltip"),e._UZ(5,"clr-icon",15),e.YNc(6,re,4,3,"clr-tooltip-content",16),e.qZA()(),e.TgZ(7,"clr-toggle-wrapper",40)(8,"input",41),e.NdJ("ngModelChange",function(n){e.CHM(r);const o=e.oxw();return e.KtG(o.enableProxyCache=n)}),e.qZA()(),e.YNc(9,se,4,2,"div",42),e.qZA()}if(2&i){const r=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,3,"PROJECT.PROXY_CACHE")," "),e.xp6(6),e.Q6J("ngModel",r.enableProxyCache),e.xp6(1),e.Q6J("ngIf",r.enableProxyCache)}}function ae(i,u){1&i&&(e.TgZ(0,"div",47)(1,"span",48),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"a",49),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"REPLICATION.NO_ENDPOINT_INFO")),e.xp6(3),e.Oqu(e.lcZ(6,4,"REPLICATION.ENDPOINTS")))}const U=100;let D=(()=>{var i;class u{constructor(t,n,o,d){this.projectService=t,this.translateService=n,this.messageHandlerService=o,this.endpointService=d,this.quotaUnits=a.NZ,this.project=new s,this.storageLimitUnit=a.NZ[3].UNIT,this.initVal=new s,this.isSubmitOnGoing=!1,this.staticBackdrop=!0,this.closable=!1,this.isNameExisted=!1,this.nameTooltipText="PROJECT.NAME_TOOLTIP",this.checkOnGoing=!1,this.enableProxyCache=!1,this.endpoint="",this.create=new e.vpe,this.registries=[],this.supportedRegistryTypeQueryString="type={docker-hub harbor azure-acr aws-ecr google-gcr quay docker-registry github-ghcr jfrog-artifactory}"}ngOnInit(){this.isSystemAdmin&&this.getRegistries()}getRegistries(){this.endpointService.listRegistriesResponse({page:1,pageSize:U,q:this.supportedRegistryTypeQueryString}).subscribe(t=>{if(t.headers){const n=t.headers.get("X-Total-Count"),o=parseInt(n,0);let d=t.body||[];if(o<=U)this.registries=t.body||[];else{const b=Math.ceil(o/U),O=[];for(let A=2;A<=b;A++)O.push(this.endpointService.listRegistries({page:A,pageSize:U,q:this.supportedRegistryTypeQueryString}));(0,Z.D)(O).subscribe(A=>{A&&A.length&&(A.forEach(J=>{d=d.concat(J)}),this.registries=d)})}}},t=>{this.messageHandlerService.error(t)})}ngAfterViewInit(){this.checkNameSubscribe||(this.checkNameSubscribe=(0,T.R)(this.projectNameInput.nativeElement,"input").pipe((0,f.U)(t=>t.target.value),(0,v.b)(300),(0,C.x)(),(0,E.h)(t=>this.currentForm.controls.create_project_name.valid&&t.length>0),(0,y.w)(t=>(this.checkOnGoing=!0,this.isNameExisted=!1,this.projectService.listProjects({q:encodeURIComponent(`name=${t}`)})))).subscribe(t=>{t&&t.length&&(this.isNameExisted=!0),this.checkOnGoing=!1},t=>{this.checkOnGoing=!1,this.isNameExisted=!1}))}get isNameValid(){return!(this.currentForm&&this.currentForm.controls&&this.currentForm.controls.create_project_name&&(this.currentForm.controls.create_project_name.dirty||this.currentForm.controls.create_project_name.touched)&&!this.checkOnGoing&&(this.currentForm.controls.create_project_name.errors?(this.nameTooltipText="PROJECT.NAME_TOOLTIP",1):this.isNameExisted&&(this.nameTooltipText="PROJECT.NAME_ALREADY_EXISTS",1)))}ngOnChanges(t){t&&t.quotaObj&&t.quotaObj.currentValue&&(this.storageLimit=(0,l.gv)(this.quotaObj.storage_per_project,(0,l.d9)(a.NZ),0,(0,l.d9)(a.NZ)).partNumberHard,this.storageLimitUnit=this.storageLimit===a.GI?a.NZ[3].UNIT:(0,l.gv)(this.quotaObj.storage_per_project,(0,l.d9)(a.NZ),0,(0,l.d9)(a.NZ)).partCharacterHard,this.storageDefaultLimit=this.storageLimit,this.storageDefaultLimitUnit=this.storageLimitUnit,this.isSystemAdmin&&this.currentForm.form.controls.create_project_storage_limit.setValidators([h.kI.required,h.kI.pattern("(^-1$)|(^([1-9]+)([0-9]+)*$)"),(0,l.CG)(this.currentForm.form.controls.create_project_storage_limit_unit)]),this.currentForm.form.valueChanges.pipe((0,C.x)((n,o)=>JSON.stringify(n)===JSON.stringify(o))).subscribe(n=>{["create_project_storage_limit","create_project_storage_limit_unit"].forEach(o=>{this.currentForm.form.get(o)&&null!==this.currentForm.form.get(o).value&&this.currentForm.form.get(o).updateValueAndValidity()})}))}ngOnDestroy(){this.checkNameSubscribe&&(this.checkNameSubscribe.unsubscribe(),this.checkNameSubscribe=null)}onSubmit(){if(this.isSubmitOnGoing)return;this.isSubmitOnGoing=!0;const t=+this.storageLimit===a.GI?this.storageLimit:(0,l.J1)(+this.storageLimit,this.storageLimitUnit);this.projectService.createProject({project:{project_name:this.project.name,metadata:{public:this.project.metadata.public?"true":"false"},storage_limit:+t,registry_id:this.enableProxyCache?+this.project.registry_id:null}}).subscribe(o=>{this.isSubmitOnGoing=!1,this.create.emit(!0),this.messageHandlerService.showSuccess("PROJECT.CREATED_SUCCESS"),this.createProjectOpened=!1},o=>{this.isSubmitOnGoing=!1,this.inlineAlert.showInlineError(o)})}onCancel(){this.createProjectOpened=!1}newProject(){this.project=new s,this.hasChanged=!1,this.createProjectOpened=!0,this.enableProxyCache=!1,this.endpoint="",this.currentForm&&this.currentForm.controls&&this.currentForm.controls.create_project_name&&this.currentForm.controls.create_project_name.reset(),this.inlineAlert.close(),this.storageLimit=this.storageDefaultLimit,this.storageLimitUnit=this.storageDefaultLimitUnit}get isValid(){return this.currentForm&&this.currentForm.valid&&!this.isSubmitOnGoing&&this.isNameValid&&!this.checkOnGoing}getEndpoint(){if(this.registries&&this.registries.length&&this.project.registry_id)for(let t=0;t<this.registries.length;t++)if(+this.registries[t].id==+this.project.registry_id)return this.registries[t].url;return""}}return(i=u).\u0275fac=function(t){return new(t||i)(e.Y36(P.Y),e.Y36(_.sK),e.Y36(R.d),e.Y36(z.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["create-project"]],viewQuery:function(t,n){if(1&t&&(e.Gf(H,7),e.Gf(g.l,7),e.Gf(W,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.currentForm=o.first),e.iGM(o=e.CRH())&&(n.inlineAlert=o.first),e.iGM(o=e.CRH())&&(n.projectNameInput=o.first)}},inputs:{quotaObj:"quotaObj",isSystemAdmin:"isSystemAdmin"},outputs:{create:"create"},features:[e.TTD],decls:52,vars:39,consts:[[3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],[1,"modal-title"],[1,"modal-body","modal-height"],[1,"clr-form","clr-form-horizontal"],["projectForm","ngForm"],[1,"clr-form-control"],[1,"required","clr-control-label"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["type","text","id","create_project_name","name","create_project_name","required","","pattern","^[a-z0-9]+(?:[._-][a-z0-9]+)*$","autocomplete","off",1,"clr-input","input-width",3,"ngModel","ngModelChange"],["projectName",""],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"spinner","spinner-inline",3,"hidden"],["class","tooltip-content",4,"ngIf"],[1,"form-group-label-override"],["clrTooltipTrigger","","shape","info-circle","size","24"],["clrPosition","bottom-left","clrSize","lg",4,"clrIfOpen"],["clrCheckbox","","type","checkbox","id","create_project_public","name","public",3,"ngModel","ngModelChange"],["class","clr-form-control",4,"ngIf"],[1,"clr-form-control","mt-0"],["for","create_project_storage_limit",1,"clr-control-label"],[1,"clr-control-container","input-width"],["class","space-between",4,"ngIf"],[1,"clr-form-control","mt-05"],[1,"clr-control-label","endpoint","required"],["placeholder","http(s)://192.168.1.1","readonly","","type","text","id","endpoint","autocomplete","off",1,"clr-input",3,"value"],[1,"modal-footer"],["id","new-project-cancel","type","button",1,"btn","btn-outline",3,"click"],["id","new-project-ok","type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"tooltip-content"],["id","name-error"],["clrPosition","bottom-left","clrSize","lg"],["for","create_project_storage_limit",1,"required","clr-control-label"],["type","text","id","create_project_storage_limit","name","create_project_storage_limit","autocomplete","off",1,"mr-10","clr-input","width-182",3,"ngModel","ngModelChange"],["projectStorageLimit","ngModel"],[1,"clr-select-wrapper"],["id","create_project_storage_limit_unit","name","create_project_storage_limit_unit",3,"ngModel","ngModelChange"],["ngFor","",3,"ngForOf"],[3,"value",4,"ngIf"],[3,"value"],[1,"mt-02"],["type","checkbox","clrToggle","","name","proxy-cache","id","proxy-cache",3,"ngModel","ngModelChange"],["class","clr-select-wrapper ml-1",4,"ngIf"],[1,"clr-select-wrapper","ml-1"],["id","registry","name","registry",1,"width-164",3,"ngModel","ngModelChange"],["value","",1,"display-none"],[3,"value",4,"ngFor","ngForOf"],[1,"space-between"],[1,"alert-label"],["routerLink","/harbor/registries",1,"alert-label","go-link"]],template:function(t,n){1&t&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(d){return n.createProjectOpened=d}),e.TgZ(1,"h3",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2),e._UZ(5,"inline-alert"),e.TgZ(6,"form",3,4)(8,"div",5)(9,"label",6),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",7)(13,"div",8)(14,"input",9,10),e.NdJ("ngModelChange",function(d){return n.project.name=d}),e.qZA(),e._UZ(16,"clr-icon",11)(17,"span",12),e.qZA(),e.YNc(18,k,4,3,"clr-control-error",13),e.qZA()(),e.TgZ(19,"clr-checkbox-container")(20,"label",14),e._uU(21),e.ALo(22,"translate"),e.TgZ(23,"clr-tooltip"),e._UZ(24,"clr-icon",15),e.YNc(25,K,4,3,"clr-tooltip-content",16),e.qZA()(),e.TgZ(26,"clr-checkbox-wrapper")(27,"input",17),e.NdJ("ngModelChange",function(d){return n.project.metadata.public=d}),e.qZA(),e.TgZ(28,"label"),e._uU(29),e.ALo(30,"translate"),e.qZA()()(),e.YNc(31,ie,15,9,"div",18),e.YNc(32,le,10,5,"div",18),e.TgZ(33,"div",19),e._UZ(34,"label",20),e.TgZ(35,"div",21),e.YNc(36,ae,7,6,"div",22),e.qZA()(),e.TgZ(37,"div",23),e._UZ(38,"label",20),e.TgZ(39,"div",7)(40,"div",8)(41,"label",24),e._uU(42),e.ALo(43,"translate"),e.qZA(),e._UZ(44,"input",25),e.qZA()()()()(),e.TgZ(45,"div",26)(46,"button",27),e.NdJ("click",function(){return n.onCancel()}),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"button",28),e.NdJ("click",function(){return n.onSubmit()}),e._uU(50),e.ALo(51,"translate"),e.qZA()()()),2&t&&(e.Q6J("clrModalOpen",n.createProjectOpened)("clrModalStaticBackdrop",n.staticBackdrop)("clrModalClosable",n.closable),e.xp6(2),e.Oqu(e.lcZ(3,25,"PROJECT.NEW_PROJECT")),e.xp6(8),e.Oqu(e.lcZ(11,27,"PROJECT.NAME")),e.xp6(2),e.ekj("clr-error",!n.isNameValid),e.xp6(2),e.Q6J("ngModel",n.project.name),e.xp6(3),e.Q6J("hidden",!n.checkOnGoing),e.xp6(1),e.Q6J("ngIf",!n.isNameValid),e.xp6(3),e.hij("",e.lcZ(22,29,"PROJECT.ACCESS_LEVEL")," "),e.xp6(6),e.Q6J("ngModel",n.project.metadata.public),e.xp6(2),e.Oqu(e.lcZ(30,31,"PROJECT.PUBLIC")),e.xp6(2),e.Q6J("ngIf",n.isSystemAdmin),e.xp6(1),e.Q6J("ngIf",n.isSystemAdmin),e.xp6(1),e.Udp("visibility",n.isSystemAdmin&&n.enableProxyCache?"visible":"hidden"),e.xp6(3),e.Q6J("ngIf",n.enableProxyCache&&!n.registries.length),e.xp6(1),e.Udp("visibility",n.isSystemAdmin&&n.enableProxyCache?"visible":"hidden"),e.xp6(5),e.Oqu(e.lcZ(43,33,"PROJECT.ENDPOINT")),e.xp6(2),e.Q6J("value",n.getEndpoint()),e.xp6(3),e.hij(" ",e.lcZ(48,35,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("disabled",!n.isValid||n.enableProxyCache&&!n.project.registry_id),e.xp6(1),e.hij(" ",e.lcZ(51,37,"BUTTON.OK")," "))},dependencies:[h._Y,h.YN,h.Kr,h.Fj,h.Wl,h.EJ,h.JJ,h.JL,h.Q7,h.c5,h.On,h.F,m.qvL,m.qAN,m.VLi,m.nqY,m.MgK,m.VqA,m.KKC,m.Y_4,m.PEh,m.Jmj,m.bMv,m.zDF,j.sg,j.O5,g.l,M.rH,_.X$],styles:[".mr-10[_ngcontent-%COMP%]{margin-right:.5rem}.display-flex[_ngcontent-%COMP%]{display:flex;align-items:center}.pos-inherit[_ngcontent-%COMP%]{position:inherit}.clr-error[_ngcontent-%COMP%]   .clr-select-wrapper[_ngcontent-%COMP%]:after{right:.25rem!important}.input-width[_ngcontent-%COMP%]{width:242px}.mt-02[_ngcontent-%COMP%]{margin-top:.2rem}.width-164[_ngcontent-%COMP%]{width:164px}.endpoint[_ngcontent-%COMP%]{display:inline-block;width:72px}.display-none[_ngcontent-%COMP%]{display:none}.space-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.go-link[_ngcontent-%COMP%]{line-height:1rem;cursor:pointer}.alert-label[_ngcontent-%COMP%]{color:red;font-size:12px}.width-182[_ngcontent-%COMP%]{width:182px}.mt-05[_ngcontent-%COMP%]{margin-top:.5rem}"]}),u})();var ce=c(2096),L=c(2141),w=c(4716),pe=c(6306),S=c(6126),de=c(9862),F=c(3924),ge=c(6266),Q=c(3555),ue=c(359),he=c(7477),_e=c(8383);const me=["names"],fe=["exportCVEForm"];function Ce(i,u){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const r=e.oxw();e.xp6(1),e.hij("(",null==r.selectedProjects?null:r.selectedProjects.length,")")}}function Te(i,u){if(1&i&&e._UZ(0,"hbr-label-piece",35),2&i){const r=e.oxw().$implicit;e.Q6J("hasIcon",!1)("label",r)("labelWidth",84)}}function Pe(i,u){if(1&i&&(e.ynx(0),e.YNc(1,Te,1,3,"hbr-label-piece",34),e.BQk()),2&i){const r=u.index;e.xp6(1),e.Q6J("ngIf",r<=0)}}function ve(i,u){1&i&&(e.TgZ(0,"span",36),e._uU(1,"\xb7\xb7\xb7"),e.qZA())}function be(i,u){1&i&&e._UZ(0,"clr-spinner",39),2&i&&e.Q6J("clrMedium",!0)}function Oe(i,u){if(1&i){const r=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){const o=e.CHM(r).$implicit,d=e.oxw(3);return e.KtG(d.selectOrUnselect(o))}),e._UZ(1,"clr-icon",43)(2,"hbr-label-piece",44),e.qZA()}if(2&i){const r=u.$implicit,t=e.oxw(3);e.xp6(1),e.Udp("visibility",t.isSelected(r)?"visible":"hidden"),e.xp6(1),e.Q6J("label",r)("labelWidth",130)}}function Ee(i,u){1&i&&(e.TgZ(0,"button",45)(1,"span",46),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",47),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"REPLICATION.NO_LABEL_INFO")),e.xp6(3),e.Oqu(e.lcZ(6,4,"CONFIG.LABEL")))}function Ze(i,u){if(1&i&&(e.ynx(0),e.YNc(1,Oe,3,4,"button",40),e.YNc(2,Ee,7,6,"button",41),e.BQk()),2&i){const r=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",r.allLabels),e.xp6(1),e.Q6J("ngIf",!(null!=r.allLabels&&r.allLabels.length))}}const xe=function(){return{"max-height.px":230}};function ye(i,u){if(1&i&&(e.TgZ(0,"clr-dropdown-menu",37),e.YNc(1,be,1,1,"clr-spinner",38),e.YNc(2,Ze,3,2,"ng-container",13),e.qZA()),2&i){const r=e.oxw();e.Q6J("ngStyle",e.DdM(3,xe)),e.xp6(1),e.Q6J("ngIf",r.loadingAllLabels),e.xp6(1),e.Q6J("ngIf",!r.loadingAllLabels)}}let Y=(()=>{var i;class u{constructor(t,n,o,d){this.labelService=t,this.scanDataExportService=n,this.msgHandler=o,this.event=d,this.triggerExportSuccess=new e.vpe,this.selectedProjects=[],this.opened=!1,this.loading=!1,this.selectedLabels=[],this.loadingAllLabels=!1,this.allLabels=[],this.saveBtnState=m.xp5.DEFAULT}reset(){this.inlineAlertComponent?.close(),this.selectedProjects=[],this.repos=null,this.tags=null,this.selectedLabels=[],this.CVEIds=null,this.currentForm?.reset(),this.allLabels=[]}open(t){this.reset(),this.opened=!0,this.selectedProjects=t,this.getAllLabels()}close(){this.opened=!1}cancel(){this.close()}save(){this.loading=!0,this.saveBtnState=m.xp5.LOADING;const t={criteria:{projects:this.selectedProjects.map(n=>n.project_id),labels:this.selectedLabels.map(n=>n.id),repositories:this.handleBrace(this.repos),tags:this.handleBrace(this.tags),cveIds:this.handleBrace(this.CVEIds)},XScanDataType:"application/vnd.security.vulnerability.report; version=1.1"};this.scanDataExportService.exportScanData(t).pipe((0,w.x)(()=>{this.loading=!1,this.saveBtnState=m.xp5.DEFAULT})).subscribe(n=>{this.triggerExportSuccess.emit(),this.msgHandler.showSuccess("CVE_EXPORT.TRIGGER_EXPORT_SUCCESS"),this.event.publish(Q.n.REFRESH_EXPORT_JOBS),this.close()},n=>{this.inlineAlertComponent.showInlineError(n)})}inputName(){}isSelected(t){let n=!1;return this.selectedLabels.forEach(o=>{o.id===t.id&&(n=!0)}),n}selectOrUnselect(t){this.isSelected(t)?this.selectedLabels=this.selectedLabels.filter(n=>n.id!==t.id):this.selectedLabels.push(t)}getProjectNames(){if(this.selectedProjects?.length){const t=[];return this.selectedProjects.forEach(n=>{t.push(n.name)}),t.join(", ")}return"CVE_EXPORT.ALL_PROJECTS"}isOverflow(){return!(this.namesSpan?.nativeElement?.clientWidth>=this.namesSpan?.nativeElement?.scrollWidth)}getAllLabels(){this.loadingAllLabels=!0,this.labelService.getAllGlobalAndSpecificProjectLabels(this.selectedProjects[0].project_id).pipe((0,w.x)(()=>this.loadingAllLabels=!1)).subscribe(t=>{this.allLabels=t})}handleBrace(t){return t?-1!==t.indexOf(",")&&-1===t.indexOf("{")&&-1===t.indexOf("}")?`{${t}}`:t:null}}return(i=u).\u0275fac=function(t){return new(t||i)(e.Y36(ue.Q),e.Y36(he.f),e.Y36(R.d),e.Y36(Q.P))},i.\u0275cmp=e.Xpm({type:i,selectors:[["export-cve"]],viewQuery:function(t,n){if(1&t&&(e.Gf(me,7),e.Gf(fe,7),e.Gf(g.l,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.namesSpan=o.first),e.iGM(o=e.CRH())&&(n.currentForm=o.first),e.iGM(o=e.CRH())&&(n.inlineAlertComponent=o.first)}},outputs:{triggerExportSuccess:"triggerExportSuccess"},decls:82,vars:57,consts:[["clrModalSize","md",3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],[1,"modal-title"],[1,"modal-body"],[1,"mt-0"],[1,"clr-form","clr-form-horizontal"],["exportCVEForm","ngForm"],[1,"form-block"],[1,"clr-form-control"],[1,"clr-control-label","required"],[1,"clr-control-container"],[1,"clr-input-wrapper","flex"],[1,"names"],["names",""],[4,"ngIf"],["for","repo",1,"clr-control-label"],[1,"clr-input-wrapper"],[1,"sub-label"],["placeholder","**","autocomplete","off","type","text","id","repo","size","30","name","repo",1,"clr-input","width-220",3,"disabled","ngModel","ngModelChange"],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"margin-left-90px","opacity-08"],[1,"clr-form-control","margin-top-06"],["placeholder","**","autocomplete","off","type","text","id","tag","size","30","name","tag",1,"clr-input","width-220",3,"disabled","ngModel","ngModelChange"],[1,"dropdown","clr-select-wrapper","absolute"],[1,"width-tag-label"],[1,"label-text"],["clrDropdownTrigger","",1,"dropdown-toggle","labels"],[4,"ngFor","ngForOf"],["class","ellipsis color-white-dark",4,"ngIf"],["class","right-align","clrPosition","bottom-left",3,"ngStyle",4,"clrIfOpen"],["for","ids",1,"clr-control-label"],["autocomplete","off","type","text","id","ids","size","30","name","tag",1,"clr-input","width-220",3,"disabled","ngModel","ngModelChange"],[1,"modal-footer"],["id","system-robot-cancel","type","button",1,"btn","btn-outline",3,"disabled","click"],["id","system-robot-save","type","button",1,"btn","btn-primary",3,"clrLoading","disabled","click"],[3,"hasIcon","label","labelWidth",4,"ngIf"],[3,"hasIcon","label","labelWidth"],[1,"ellipsis","color-white-dark"],["clrPosition","bottom-left",1,"right-align",3,"ngStyle"],["class","spinner",3,"clrMedium",4,"ngIf"],[1,"spinner",3,"clrMedium"],["type","button","class","dropdown-item flex",3,"click",4,"ngFor","ngForOf"],["type","button","class","dropdown-item space-between no-labels",4,"ngIf"],["type","button",1,"dropdown-item","flex",3,"click"],["shape","check"],[3,"label","labelWidth"],["type","button",1,"dropdown-item","space-between","no-labels"],[1,"alert-label"],["routerLink","/harbor/labels",1,"alert-label","go-link"]],template:function(t,n){1&t&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(d){return n.opened=d}),e.TgZ(1,"h3",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2),e._UZ(5,"inline-alert",1),e.TgZ(6,"p",3),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"form",4,5)(11,"section",6)(12,"div",7)(13,"label",8),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"div",9)(17,"div",10)(18,"span",11,12),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.YNc(22,Ce,2,1,"span",13),e.qZA()()(),e.TgZ(23,"div",7)(24,"label",14),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"div",9)(28,"div",15)(29,"label",16),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"input",17),e.NdJ("ngModelChange",function(d){return n.repos=d}),e.qZA(),e._UZ(33,"clr-icon",18),e.qZA(),e.TgZ(34,"clr-control-helper",19),e._uU(35),e.ALo(36,"translate"),e.qZA()()(),e.TgZ(37,"div",20),e._UZ(38,"label",14),e.TgZ(39,"div",9)(40,"div",15)(41,"label",16),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"input",21),e.NdJ("ngModelChange",function(d){return n.tags=d}),e.qZA(),e._UZ(45,"clr-icon",18),e.qZA(),e.TgZ(46,"clr-control-helper",19),e._uU(47),e.ALo(48,"translate"),e.qZA()()(),e.TgZ(49,"div",20),e._UZ(50,"label",14),e.TgZ(51,"div",9)(52,"div",15)(53,"label",16),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"div",22)(57,"clr-dropdown",23)(58,"div",24)(59,"div",25),e.YNc(60,Pe,2,1,"ng-container",26),e.YNc(61,ve,2,0,"span",27),e.qZA()(),e.YNc(62,ye,3,4,"clr-dropdown-menu",28),e.qZA()()()()(),e.TgZ(63,"div",20),e._UZ(64,"label",29),e.TgZ(65,"div",9)(66,"div",15)(67,"label",16),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"input",30),e.NdJ("ngModelChange",function(d){return n.CVEIds=d}),e.qZA(),e._UZ(71,"clr-icon",18),e.qZA(),e.TgZ(72,"clr-control-helper",19),e._uU(73),e.ALo(74,"translate"),e.qZA()()()()()(),e.TgZ(75,"div",31)(76,"button",32),e.NdJ("click",function(){return n.cancel()}),e._uU(77),e.ALo(78,"translate"),e.qZA(),e.TgZ(79,"button",33),e.NdJ("click",function(){return n.save()}),e._uU(80),e.ALo(81,"translate"),e.qZA()()()),2&t&&(e.Q6J("clrModalOpen",n.opened)("clrModalStaticBackdrop",!0)("clrModalClosable",!0),e.xp6(2),e.Oqu(e.lcZ(3,29,"CVE_EXPORT.EXPORT_TITLE")),e.xp6(5),e.Oqu(e.lcZ(8,31,"CVE_EXPORT.EXPORT_SUBTITLE")),e.xp6(7),e.Oqu(e.lcZ(15,33,"SIDE_NAV.PROJECTS")),e.xp6(6),e.hij("",e.lcZ(21,35,n.getProjectNames())," "),e.xp6(2),e.Q6J("ngIf",n.isOverflow()&&!(null==n.selectedProjects||!n.selectedProjects.length)),e.xp6(3),e.Oqu(e.lcZ(26,37,"P2P_PROVIDER.FILTERS")),e.xp6(5),e.Oqu(e.lcZ(31,39,"P2P_PROVIDER.REPOS")),e.xp6(2),e.Q6J("disabled",n.loading)("ngModel",n.repos),e.xp6(3),e.Oqu(e.lcZ(36,41,"TAG_RETENTION.REP_SEPARATOR")),e.xp6(7),e.Oqu(e.lcZ(43,43,"P2P_PROVIDER.TAGS")),e.xp6(2),e.Q6J("disabled",n.loading)("ngModel",n.tags),e.xp6(3),e.Oqu(e.lcZ(48,45,"P2P_PROVIDER.TAG_SEPARATOR")),e.xp6(7),e.Oqu(e.lcZ(55,47,"P2P_PROVIDER.LABELS")),e.xp6(6),e.Q6J("ngForOf",n.selectedLabels),e.xp6(1),e.Q6J("ngIf",n.selectedLabels.length>1),e.xp6(7),e.Oqu(e.lcZ(69,49,"CVE_EXPORT.CVE_IDS")),e.xp6(2),e.Q6J("disabled",n.loading)("ngModel",n.CVEIds),e.xp6(3),e.Oqu(e.lcZ(74,51,"CVE_EXPORT.EXPORT_CVE_FILTER_HELP_TEXT")),e.xp6(3),e.Q6J("disabled",n.loading),e.xp6(1),e.hij(" ",e.lcZ(78,53,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("clrLoading",n.saveBtnState)("disabled",n.loading||n.currentForm.invalid),e.xp6(1),e.hij(" ",e.lcZ(81,55,"CVE_EXPORT.EXPORT_BUTTON")," "))},dependencies:[h._Y,h.Fj,h.JJ,h.JL,h.On,h.F,m.qvL,m.qAN,m.VLi,m.cCV,m.nqY,m.MPb,m.MgK,m.CM6,m.f_W,m.zwp,m.ZUS,m.vNO,j.sg,j.O5,j.PC,g.l,_e.q,M.rH,_.X$],styles:[".sub-label[_ngcontent-%COMP%]{display:inline-block;width:90px;font-size:.5417rem;font-weight:400}.width-220[_ngcontent-%COMP%]{width:220px}.label-text[_ngcontent-%COMP%]{text-transform:none;letter-spacing:normal;font-size:13px;font-weight:400;color:#000;height:1.2rem;margin:0!important;line-height:1rem;text-align:left;padding-left:6px;outline:none;border-bottom:1px solid rgb(154,154,154)}.dropdown-toggle[_ngcontent-%COMP%]{height:24px;width:212px}.right-align[_ngcontent-%COMP%]{min-width:220px;overflow-y:auto}.no-labels[_ngcontent-%COMP%]{cursor:default;padding:0 .5rem}.dropdown-item[_ngcontent-%COMP%]{min-height:26px}.spinner[_ngcontent-%COMP%]{margin:auto}.absolute[_ngcontent-%COMP%]{position:absolute}.flex[_ngcontent-%COMP%]{display:flex}.clr-control-label[_ngcontent-%COMP%]{width:8rem!important}.names[_ngcontent-%COMP%]{text-overflow:ellipsis;max-width:270px;display:inline-block;overflow:hidden}.space-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.input-width[_ngcontent-%COMP%]{width:310px}.labels[_ngcontent-%COMP%]{display:flex;justify-content:left}"]}),u})();var N=c(1575),je=c(6682),Se=c(4766),Re=c(8645);let G=(()=>{var i;class u{constructor(){this.refreshSource=new Re.x,this.refreshChan$=this.refreshSource.asObservable()}refresh(){this.refreshSource.next(!0)}}return(i=u).\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),u})();var Me=c(3612),Le=c(7546),Ie=c(4410);function Ue(i,u){if(1&i){const r=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(r);const n=e.oxw();return e.KtG(n.addNewProject())}),e._UZ(1,"clr-icon",13),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&i&&(e.xp6(2),e.hij("\xa0",e.lcZ(3,1,"PROJECT.NEW_PROJECT")," "))}function we(i,u){if(1&i){const r=e.EpF();e.TgZ(0,"clr-dropdown-menu")(1,"button",14),e.NdJ("click",function(){e.CHM(r);const n=e.oxw();return e.KtG(n.exportCVE())}),e._UZ(2,"clr-icon",15),e._uU(3,"\xa0 "),e.TgZ(4,"span",16),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e._UZ(7,"div",17),e.TgZ(8,"button",18),e.NdJ("click",function(){e.CHM(r);const n=e.oxw();return e.KtG(n.deleteProjects(n.selectedRow))}),e._UZ(9,"clr-icon",19),e._uU(10,"\xa0 "),e.TgZ(11,"span"),e._uU(12),e.ALo(13,"translate"),e.qZA()()()}if(2&i){const r=e.oxw();e.xp6(1),e.Q6J("disabled",!r.hasPermission||!r.canClickExport),e.xp6(4),e.Oqu(e.lcZ(6,4,"CVE_EXPORT.EXPORT_SOME_PROJECTS")),e.xp6(3),e.Q6J("disabled",!r.canDelete),e.xp6(4),e.Oqu(e.lcZ(13,6,"PROJECT.DELETE"))}}function qe(i,u){if(1&i){const r=e.EpF();e.TgZ(0,"clr-dg-row",20)(1,"clr-dg-cell")(2,"a",21),e.NdJ("click",function(){const o=e.CHM(r).$implicit,d=e.oxw();return e.KtG(d.clickLink(o.project_id))}),e._uU(3),e.qZA()(),e.TgZ(4,"clr-dg-cell"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"clr-dg-cell"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"clr-dg-cell"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"clr-dg-cell"),e._uU(14),e.qZA(),e.TgZ(15,"clr-dg-cell"),e._uU(16),e.ALo(17,"harborDatetime"),e.qZA()()}if(2&i){const r=u.$implicit,t=e.oxw();e.Q6J("clrDgItem",r),e.xp6(2),e.Q6J("routerLink",t.getLink(r.project_id)),e.xp6(1),e.Oqu(r.name),e.xp6(2),e.Oqu(e.lcZ(6,8,"true"===r.metadata.public?"PROJECT.PUBLIC":"PROJECT.PRIVATE")),e.xp6(3),e.Oqu(t.roleInfo[r.current_user_role_id]?e.lcZ(9,10,t.roleInfo[r.current_user_role_id]):"-"),e.xp6(3),e.Oqu(e.lcZ(12,12,t.projectTypeMap[r.registry_id?1:0])),e.xp6(3),e.Oqu(r.repo_count),e.xp6(2),e.Oqu(e.xi3(17,14,r.creation_time,"short"))}}function Ne(i,u){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){e.oxw();const r=e.MAs(30);e.xp6(1),e.lnq("",r.firstItem+1," - ",r.lastItem+1," ",e.lcZ(2,3,"PROJECT.OF")," ")}}const Je=function(){return[15,25,50]};let B=(()=>{var i;class u{constructor(t,n,o,d,b,O,A,J,X,Ke,$e,et){this.session=t,this.appConfigService=n,this.router=o,this.searchTrigger=d,this.proService=b,this.msgHandler=O,this.statisticHandler=A,this.translate=J,this.deletionDialogService=X,this.operationService=Ke,this.translateService=$e,this.permissionService=et,this.loading=!0,this.projects=[],this.filteredType=0,this.searchKeyword="",this.selectedRow=[],this.addProject=new e.vpe,this.roleInfo=a.Hp,this.currentPage=1,this.totalCount=0,this.pageSize=(0,l.tb)(l.V2.LIST_PROJECT_COMPONENT),this.projectTypeMap={0:"PROJECT.PROJECT",1:"PROJECT.PROXY_CACHE"},this.hasPermission=!1,this.canClickExport=!0,this.subscription=X.confirmationConfirm$.subscribe(q=>{q&&1===q.state&&1===q.source&&this.delProjects(q.data)})}get projectCreationRestriction(){let t=this.session.getCurrentUser();if(t)switch(this.appConfigService.getConfig().project_creation_restriction){case"adminonly":return t.has_admin_role;case"everyone":return!0}return!1}get isSystemAdmin(){let t=this.session.getCurrentUser();return null!=t&&t.has_admin_role}get canDelete(){return!!this.selectedRow.length&&(this.isSystemAdmin||this.selectedRow.every(t=>1===t.current_user_role_id))}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}addNewProject(){this.addProject.emit()}clickLink(t){this.searchTrigger.closeSearch(!0)}getLink(t){return`/harbor/projects/${t}/repositories`}clrLoad(t){if(!t||!t.page)return;this.state=t,this.pageSize=t.page.size,(0,l.Pe)(l.V2.LIST_PROJECT_COMPONENT,this.pageSize),this.selectedRow=[],this.currentState=t;let o,n=(0,l.wy)(t);n<=0&&(n=1),this.loading=!0,this.filteredType>0&&(o=this.filteredType-1),this.proService.listProjects(this.searchKeyword,o,n,this.pageSize,(0,l.td)(t)).pipe((0,w.x)(()=>{this.loading=!1})).subscribe(d=>{if(d.headers){let b=d.headers.get("X-Total-Count");b&&(this.totalCount=parseInt(b,0))}this.projects=d.body,this.projects?.forEach(b=>{if(this.selectedRow?.length)for(let O=this.selectedRow?.length-1;O>=0;O--)this.selectedRow[O].project_id===b.project_id&&(this.selectedRow.splice(O,1),this.selectedRow.push(b))})},d=>{this.msgHandler.handleError(d)})}newReplicationRule(t){t&&this.router.navigateByUrl(`/harbor/projects/${t.project_id}/replications?is_create=true`)}deleteProjects(t){let n=[];if(t&&t.length){t.forEach(d=>{n.push(d.name)});let o=new ge.c("PROJECT.DELETION_TITLE","PROJECT.DELETION_SUMMARY",n.join(","),t,1,2);this.deletionDialogService.openComfirmDialog(o)}}delProjects(t){let n=[];t&&t.length&&(t.forEach(o=>{n.push(this.delOperate(o))}),(0,Z.D)(...n).subscribe(o=>{let d;o&&o.length&&o.forEach(O=>{O instanceof de.UA&&(d=(0,F.Po)(O))}),d?this.msgHandler.handleError(d):this.translate.get("BATCH.DELETED_SUCCESS").subscribe(O=>{this.msgHandler.showSuccess(O)});let b=this.getStateAfterDeletion();this.selectedRow=[],b?(this.clrLoad(b),this.statisticHandler.refresh()):this.refresh()}))}delOperate(t){let n=new S.gB;return n.name="OPERATION.DELETE_PROJECT",n.data.id=t.project_id,n.state=S.yb.progressing,n.data.name=t.name,this.operationService.publishInfo(n),this.proService.deleteProject(t.project_id).pipe((0,f.U)(()=>{(0,S.hm)(n,S.yb.success)}),(0,pe.K)(o=>{const d=(0,F.Po)(o);return this.translateService.get(d).subscribe(b=>{(0,S.hm)(n,S.yb.failure,b)}),(0,ce.of)(o)}))}refresh(){this.currentPage=1,this.filteredType=0,this.searchKeyword="",this.selectedRow=[],this.reload(),this.statisticHandler.refresh()}doFilterProject(t){this.currentPage=1,this.filteredType=t,this.reload()}doSearchProject(t){this.currentPage=1,this.searchKeyword=t,this.reload()}reload(){let t=this.currentState;t||(t={page:{}}),t.page.from=0,t.page.to=this.pageSize-1,t.page.size=this.pageSize,this.clrLoad(t)}getStateAfterDeletion(){let t=this.totalCount-this.selectedRow.length;if(t<=0)return null;let n=Math.ceil(t/this.pageSize),o=this.currentPage;this.currentPage>n&&(o=n);let d=this.currentState;return d||(d={page:{}}),d.page.size=this.pageSize,d.page.from=(o-1)*this.pageSize,d.page.to=o*this.pageSize-1,d}exportCVE(){this.exportCveComponent.open(this.selectedRow)}selectionChanged(){if(this.hasPermission=!1,this.selectedRow?.length&&this.selectedRow?.length<=1){const t=[];this.selectedRow.forEach(n=>{t.push(this.permissionService.getPermission(n.project_id,L._W.EXPORT_CVE.KEY,L._W.EXPORT_CVE.VALUE.CREATE))}),(0,Z.D)(t).subscribe(n=>{n?.length&&(this.hasPermission=n.every(o=>o))})}}triggerExportSuccess(){this.canClickExport=!1,setTimeout(()=>{this.canClickExport=!0},3e4)}}return(i=u).\u0275fac=function(t){return new(t||i)(e.Y36(N.m),e.Y36(je._),e.Y36(M.F0),e.Y36(Se.V),e.Y36(L.Y4),e.Y36(R.d),e.Y36(G),e.Y36(_.sK),e.Y36(Me.O),e.Y36(Le.f9),e.Y36(_.sK),e.Y36(L.Hx))},i.\u0275cmp=e.Xpm({type:i,selectors:[["list-project"]],viewQuery:function(t,n){if(1&t&&e.Gf(Y,5),2&t){let o;e.iGM(o=e.CRH())&&(n.exportCveComponent=o.first)}},outputs:{addProject:"addProject"},decls:38,vars:41,consts:[[3,"clrDgLoading","clrDgSelected","clrDgRefresh","clrDgSelectedChange"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["clrDropdownTrigger","",1,"btn","btn-link",3,"clrCloseMenuOnItemClick"],["shape","caret\n            down"],[4,"clrIfOpen"],[3,"clrDgSortBy"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgPageSize","clrDgPage","clrDgTotalItems","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[4,"ngIf"],[3,"triggerExportSuccess"],["type","button",1,"btn","btn-secondary",3,"click"],["shape","plus","size","16"],["clrDropdownItem","",3,"disabled","click"],["shape","export","size","16"],["id","export-cve"],[1,"dropdown-divider"],["id","delete-project","type","button",1,"btn","btn-secondary",3,"disabled","click"],["shape","times","size","16"],[3,"clrDgItem"],["href","javascript:void(0)",3,"routerLink","click"]],template:function(t,n){1&t&&(e.TgZ(0,"clr-datagrid",0),e.NdJ("clrDgRefresh",function(d){return n.clrLoad(d)})("clrDgSelectedChange",function(d){return n.selectedRow=d})("clrDgSelectedChange",function(){return n.selectionChanged()}),e.TgZ(1,"clr-dg-action-bar"),e.YNc(2,Ue,4,3,"button",1),e.TgZ(3,"clr-dropdown",2)(4,"span"),e._uU(5),e.ALo(6,"translate"),e._UZ(7,"clr-icon",3),e.qZA(),e.YNc(8,we,14,8,"clr-dropdown-menu",4),e.qZA()(),e.TgZ(9,"clr-dg-column",5),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"clr-dg-column"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"clr-dg-column"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"clr-dg-column"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"clr-dg-column"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"clr-dg-column",5),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.YNc(27,qe,18,17,"clr-dg-row",6),e.TgZ(28,"clr-dg-footer")(29,"clr-dg-pagination",7,8),e.NdJ("clrDgPageChange",function(d){return n.currentPage=d}),e.TgZ(31,"clr-dg-page-size",9),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.YNc(34,Ne,3,5,"span",10),e._uU(35),e.ALo(36,"translate"),e.qZA()()(),e.TgZ(37,"export-cve",11),e.NdJ("triggerExportSuccess",function(){return n.triggerExportSuccess()}),e.qZA()),2&t&&(e.Q6J("clrDgLoading",n.loading)("clrDgSelected",n.selectedRow),e.xp6(2),e.Q6J("ngIf",n.projectCreationRestriction),e.xp6(1),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(2),e.Oqu(e.lcZ(6,22,"MEMBER.ACTION")),e.xp6(4),e.Q6J("clrDgSortBy","name"),e.xp6(1),e.Oqu(e.lcZ(11,24,"PROJECT.NAME")),e.xp6(3),e.Oqu(e.lcZ(14,26,"PROJECT.ACCESS_LEVEL")),e.xp6(3),e.Oqu(e.lcZ(17,28,"PROJECT.ROLE")),e.xp6(3),e.Oqu(e.lcZ(20,30,"PROJECT.TYPE")),e.xp6(3),e.Oqu(e.lcZ(23,32,"PROJECT.REPO_COUNT")),e.xp6(2),e.Q6J("clrDgSortBy","creation_time"),e.xp6(1),e.Oqu(e.lcZ(26,34,"PROJECT.CREATION_TIME")),e.xp6(2),e.Q6J("ngForOf",n.projects),e.xp6(2),e.Q6J("clrDgPageSize",n.pageSize)("clrDgPage",n.currentPage)("clrDgTotalItems",n.totalCount),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(40,Je)),e.xp6(1),e.Oqu(e.lcZ(33,36,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",n.totalCount),e.xp6(1),e.AsE(" ",n.totalCount," ",e.lcZ(36,38,"PROJECT.ITEMS")," "))},dependencies:[m.C9t,m.Gwl,m.fv_,m.m4W,m.dRQ,m.YYR,m.Ltv,m.Z4N,m.jND,m.KHL,m.PDs,m.Gcc,m.dml,m.Nh1,m.K8c,m.qvL,m.nqY,m.f_W,m.zwp,m.ZUS,m.lU3,j.sg,j.O5,M.rH,Y,_.X$,Ie.Z],encapsulation:2}),u})();var V=c(927),Qe=c(7342),Ye=c(69);function Ge(i,u){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA()()),2&i){const r=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"STATISTICS.INDEX_PRIVATE")," "),e.xp6(3),e.hij(" ",null==r.originalCopy?null:r.originalCopy.private_project_count," ")}}function Be(i,u){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA()()),2&i){const r=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"STATISTICS.INDEX_TOTAL")," "),e.xp6(3),e.hij(" ",null==r.originalCopy?null:r.originalCopy.total_project_count," ")}}function Ve(i,u){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA()()),2&i){const r=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"STATISTICS.INDEX_PRIVATE")," "),e.xp6(3),e.hij(" ",null==r.originalCopy?null:r.originalCopy.private_repo_count," ")}}function Xe(i,u){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA()()),2&i){const r=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"STATISTICS.INDEX_TOTAL")," "),e.xp6(3),e.hij(" ",null==r.originalCopy?null:r.originalCopy.total_repo_count," ")}}function ze(i,u){if(1&i&&(e.TgZ(0,"div",1)(1,"div",9)(2,"h4",3),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",10)(6,"div")(7,"span",11),e._uU(8),e.qZA(),e.TgZ(9,"span"),e._uU(10),e.qZA()()()()()),2&i){const r=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,3,"QUOTA.QUOTA_USED")),e.xp6(5),e.Oqu(r.getSizeNumber()),e.xp6(2),e.Oqu(r.getSizeUnit())}}let He=(()=>{var i;class u{constructor(t,n,o,d){this.statistics=t,this.msgHandler=n,this.session=o,this.statisticHandler=d}ngOnInit(){this.refreshSub=this.statisticHandler.refreshChan$.subscribe(t=>{this.getStatistics()}),this.session.getCurrentUser()&&this.getStatistics()}ngOnDestroy(){this.refreshSub&&this.refreshSub.unsubscribe()}getStatistics(){this.statistics.getStatistic().subscribe(t=>this.originalCopy=t,t=>{this.msgHandler.handleError(t)})}get isValidSession(){let t=this.session.getCurrentUser();return t&&t.has_admin_role}getSizeNumber(){return this.originalCopy?(0,l.Zj)(this.originalCopy.total_storage_consumption):0}getSizeUnit(){return this.originalCopy?(0,l.T2)(this.originalCopy.total_storage_consumption):null}}return(i=u).\u0275fac=function(t){return new(t||i)(e.Y36(Ye.B),e.Y36(R.d),e.Y36(N.m),e.Y36(G))},i.\u0275cmp=e.Xpm({type:i,selectors:[["statistics-panel"]],decls:28,vars:19,consts:[[1,"clr-row","flex-end"],[1,"card"],[1,"card-block"],[1,"head"],["class","clr-row",4,"ngIf"],[1,"clr-row"],[1,"clr-col"],[1,"clr-col","font-weight-700"],["class","card",4,"ngIf"],[1,"card-block","container"],[1,"storage-used","font-weight-700"],[1,"size-number","margin-right-5px"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.YNc(6,Ge,6,4,"div",4),e.TgZ(7,"div",5)(8,"div",6),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()(),e.YNc(13,Be,6,4,"div",4),e.qZA()(),e.TgZ(14,"div",1)(15,"div",2)(16,"h4",3),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.YNc(19,Ve,6,4,"div",4),e.TgZ(20,"div",5)(21,"div",6),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"div",7),e._uU(25),e.qZA()(),e.YNc(26,Xe,6,4,"div",4),e.qZA()(),e.YNc(27,ze,11,5,"div",8),e.qZA()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,11,"STATISTICS.PRO_ITEM")),e.xp6(2),e.Q6J("ngIf",n.isValidSession),e.xp6(3),e.hij(" ",e.lcZ(10,13,"STATISTICS.INDEX_PUB")," "),e.xp6(3),e.hij(" ",null==n.originalCopy?null:n.originalCopy.public_project_count," "),e.xp6(1),e.Q6J("ngIf",n.isValidSession),e.xp6(4),e.Oqu(e.lcZ(18,15,"STATISTICS.REPO_ITEM")),e.xp6(2),e.Q6J("ngIf",n.isValidSession),e.xp6(3),e.hij(" ",e.lcZ(23,17,"STATISTICS.INDEX_PUB")," "),e.xp6(3),e.hij(" ",null==n.originalCopy?null:n.originalCopy.public_repo_count," "),e.xp6(1),e.Q6J("ngIf",n.isValidSession),e.xp6(1),e.Q6J("ngIf",n.isValidSession))},dependencies:[j.O5,_.X$],styles:[".head[_ngcontent-%COMP%]{margin-top:0;margin-bottom:.25rem}.card[_ngcontent-%COMP%]{width:10rem;margin-right:.5rem;margin-top:0}.flex-end[_ngcontent-%COMP%]{justify-content:flex-end}.font-weight-700[_ngcontent-%COMP%]{font-weight:700}.storage-used[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center}.size-number[_ngcontent-%COMP%]{font-size:1.5rem}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.margin-right-5px[_ngcontent-%COMP%]{margin-right:5px}"]}),u})();const We=[{path:"",component:(()=>{var i;class u{get selecteType(){return this.currentFilteredType+""}set selecteType(t){this.currentFilteredType=+t,window.sessionStorage&&(window.sessionStorage.projectTypeValue=+t)}constructor(t,n,o,d){this.configService=t,this.session=n,this.proService=o,this.msgHandler=d,this.projectTypes=a.sX,this.currentFilteredType=0,this.projectName=""}ngOnInit(){window.sessionStorage&&window.sessionStorage.projectTypeValue&&window.sessionStorage.fromDetails&&(this.currentFilteredType=+window.sessionStorage.projectTypeValue,window.sessionStorage.removeItem("fromDetails")),this.isSystemAdmin&&this.getConfigration(),this.searchSub||(this.searchSub=this.filterComponent.filterTerms.pipe((0,v.b)(500),(0,C.x)(),(0,y.w)(t=>{let n;return this.listProject.currentPage=1,this.listProject.searchKeyword=t,this.listProject.selectedRow=[],this.listProject.loading=!0,this.listProject.filteredType>0&&(n=this.listProject.filteredType-1),this.proService.listProjects(this.listProject.searchKeyword,n,this.listProject.currentPage,this.listProject.pageSize,(0,l.td)(this.listProject.state)).pipe((0,w.x)(()=>{this.listProject.loading=!1}))})).subscribe(t=>{if(t.headers){let n=t.headers.get("X-Total-Count");n&&(this.listProject.totalCount=parseInt(n,0))}this.listProject.projects=t.body},t=>{this.msgHandler.handleError(t)}))}ngOnDestroy(){this.searchSub&&(this.searchSub.unsubscribe(),this.searchSub=null)}getConfigration(){this.configService.getConfiguration().subscribe(t=>{this.quotaObj={storage_per_project:t.storage_per_project?t.storage_per_project.value:-1}})}get isSystemAdmin(){let t=this.session.getCurrentUser();return null!=t&&t.has_admin_role}openModal(){this.creationProject.newProject()}createProject(t){t&&this.refresh()}doFilterProjects(){this.listProject.doFilterProject(+this.selecteType)}refresh(){this.currentFilteredType=0,this.projectName="",this.listProject.refresh()}}return(i=u).\u0275fac=function(t){return new(t||i)(e.Y36(Qe.e),e.Y36(N.m),e.Y36(L.Y4),e.Y36(R.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["projects"]],viewQuery:function(t,n){if(1&t&&(e.Gf(D,5),e.Gf(B,5),e.Gf(V.z,7)),2&t){let o;e.iGM(o=e.CRH())&&(n.creationProject=o.first),e.iGM(o=e.CRH())&&(n.listProject=o.first),e.iGM(o=e.CRH())&&(n.filterComponent=o.first)}},decls:27,vars:21,consts:[[1,"row"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12","position-r"],[1,"row","flex-items-xs-between","flex-items-xs-top","projectPos"],[1,"header-title"],[1,"row","flex-items-xs-between","rightPos"],[1,"display-flex"],[1,"clr-select-wrapper"],[3,"ngModel","change","ngModelChange"],["value","0",3,"selected"],["value","1"],["value","2"],[3,"withDivider","filterPlaceholder","currentValue"],[1,"refresh-btn",3,"click"],["shape","refresh"],[3,"quotaObj","isSystemAdmin","create"],[3,"addProject"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div"),e._UZ(7,"statistics-panel"),e.qZA()(),e.TgZ(8,"div",4)(9,"div",5)(10,"div",6)(11,"select",7),e.NdJ("change",function(){return n.doFilterProjects()})("ngModelChange",function(d){return n.selecteType=d}),e.TgZ(12,"option",8),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"option",9),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"option",10),e._uU(19),e.ALo(20,"translate"),e.qZA()()(),e._UZ(21,"hbr-filter",11),e.ALo(22,"translate"),e.TgZ(23,"span",12),e.NdJ("click",function(){return n.refresh()}),e._UZ(24,"clr-icon",13),e.qZA()()(),e.TgZ(25,"create-project",14),e.NdJ("create",function(d){return n.createProject(d)}),e.qZA(),e.TgZ(26,"list-project",15),e.NdJ("addProject",function(){return n.openModal()}),e.qZA()()()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,11,"PROJECT.PROJECTS")),e.xp6(7),e.Q6J("ngModel",n.selecteType),e.xp6(1),e.Q6J("selected",0===n.currentFilteredType),e.xp6(1),e.hij(" ",e.lcZ(14,13,n.projectTypes[0])," "),e.xp6(3),e.hij(" ",e.lcZ(17,15,n.projectTypes[1])," "),e.xp6(3),e.hij(" ",e.lcZ(20,17,n.projectTypes[2])," "),e.xp6(2),e.s9C("filterPlaceholder",e.lcZ(22,19,"PROJECT.FILTER_PLACEHOLDER")),e.Q6J("withDivider",!0)("currentValue",n.projectName),e.xp6(4),e.Q6J("quotaObj",n.quotaObj)("isSystemAdmin",n.isSystemAdmin))},dependencies:[h.YN,h.Kr,h.EJ,h.JJ,h.On,m.qvL,V.z,B,D,He,_.X$],styles:[".header-title[_ngcontent-%COMP%]{margin-bottom:-34px}.option-left[_ngcontent-%COMP%]{padding-left:16px}.display-flex[_ngcontent-%COMP%]{display:flex;align-items:baseline}.refresh-btn[_ngcontent-%COMP%]{cursor:pointer}.refresh-btn[_ngcontent-%COMP%]:hover{color:#007cbb}.rightPos[_ngcontent-%COMP%]{position:absolute;z-index:100;right:35px;margin-top:28px}.projectPos[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}.position-r[_ngcontent-%COMP%]{position:relative}"]}),u})()}];let ke=(()=>{var i;class u{}return(i=u).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.m,M.Bz.forChild(We)]}),u})()},927:(I,x,c)=>{c.d(x,{z:()=>Z});var p=c(5879),f=c(8645),v=c(3620),C=c(6223),E=c(6814),y=c(8280);const e=["inputElement"];function h(T,s){1&T&&p._UZ(0,"span",4)}let Z=(()=>{var T;class s{set filterPlaceholder(l){this.placeHolder=l}constructor(l){this.cd=l,this.placeHolder="",this.filterTerms=new f.x,this.isExpanded=!1,this.filterEvt=new p.vpe,this.openFlag=new p.vpe,this.readonly=null,this.expandMode=!1,this.withDivider=!1}ngOnInit(){this.filterTerms.pipe((0,v.b)(500)).subscribe(l=>{this.filterEvt.emit(l)})}valueChange(){this.filterTerms.next(this.currentValue&&this.currentValue.trim())}inputFocus(){this.openFlag.emit(this.isExpanded)}onClick(){this.expandMode||(this.isExpanded=!this.isExpanded,this.isExpanded&&(this.cd.detectChanges(),this.inputElement.nativeElement.focus()),this.openFlag.emit(this.isExpanded))}get isShowSearchBox(){return this.expandMode||!this.expandMode&&this.isExpanded}}return(T=s).\u0275fac=function(l){return new(l||T)(p.Y36(p.sBO))},T.\u0275cmp=p.Xpm({type:T,selectors:[["hbr-filter"]],viewQuery:function(l,g){if(1&l&&p.Gf(e,5),2&l){let P;p.iGM(P=p.CRH())&&(g.inputElement=P.first)}},inputs:{readonly:"readonly",currentValue:"currentValue",filterPlaceholder:"filterPlaceholder",expandMode:"expandMode",withDivider:"withDivider",width:"width"},outputs:{filterEvt:"filterEvt",openFlag:"openFlag"},decls:5,vars:9,consts:[["shape","search","size","20",1,"search-btn",3,"click"],["type","text","autofocus","",1,"filter-input","clr-input",3,"hidden","placeholder","ngModel","keyup","focus","ngModelChange"],["inputElement",""],["class","filter-divider",4,"ngIf"],[1,"filter-divider"]],template:function(l,g){1&l&&(p.TgZ(0,"span")(1,"clr-icon",0),p.NdJ("click",function(){return g.onClick()}),p.qZA(),p.TgZ(2,"input",1,2),p.NdJ("keyup",function(){return g.valueChange()})("focus",function(){return g.inputFocus()})("ngModelChange",function(_){return g.currentValue=_}),p.qZA(),p.YNc(4,h,1,0,"span",3),p.qZA()),2&l&&(p.xp6(1),p.ekj("filter-icon",g.isShowSearchBox),p.xp6(1),p.Udp("width",g.width,"px"),p.s9C("placeholder",g.placeHolder),p.Q6J("hidden",!g.isShowSearchBox)("ngModel",g.currentValue),p.uIk("readOnly",g.readonly),p.xp6(2),p.Q6J("ngIf",g.withDivider))},dependencies:[C.Fj,C.JJ,C.On,E.O5,y.qvL],styles:[".filter-icon[_ngcontent-%COMP%]{position:relative;right:-20px}.filter-divider[_ngcontent-%COMP%]{display:inline-block;height:16px;width:1px;padding-top:12px;padding-bottom:12px;position:relative;top:9px;margin-right:6px;margin-left:6px}.search-btn[_ngcontent-%COMP%]{cursor:pointer}.search-btn[_ngcontent-%COMP%]:hover{color:#007cbb}.filter-input[_ngcontent-%COMP%]{padding-left:24px}"]}),s})()},8383:(I,x,c)=>{c.d(x,{q:()=>Z});var p=c(27),f=c(5879),v=c(6814),C=c(8280);function E(T,s){1&T&&f._UZ(0,"clr-icon",5)}function y(T,s){1&T&&f._UZ(0,"clr-icon",6)}function e(T,s){if(1&T&&(f.TgZ(0,"clr-tooltip-content",7)(1,"span"),f._uU(2),f.qZA()()),2&T){const a=f.oxw();f.Q6J("clrPosition","right"),f.xp6(2),f.Oqu(a.label.description)}}const h=function(T,s,a){return{"background-color":T,color:s,border:a}};let Z=(()=>{var T;class s{constructor(){this.hasIcon=!0,this.withTooltip=!1}ngOnChanges(){if(this.label){let l=this.label.color;l||(l="#FFFFFF"),this.labelColor=p.oW.find(g=>g.color===l)}}}return(T=s).\u0275fac=function(l){return new(l||T)},T.\u0275cmp=f.Xpm({type:T,selectors:[["hbr-label-piece"]],inputs:{label:"label",labelWidth:"labelWidth",hasIcon:"hasIcon",withTooltip:"withTooltip"},features:[f.TTD],decls:8,vars:12,consts:[["clrTooltipTrigger","",1,"label",3,"title","ngStyle"],["shape","organization",4,"ngIf"],["shape","administrator",4,"ngIf"],[1,"label-name"],[3,"clrPosition",4,"ngIf"],["shape","organization"],["shape","administrator"],[3,"clrPosition"]],template:function(l,g){1&l&&(f.TgZ(0,"clr-tooltip")(1,"label",0)(2,"span"),f.YNc(3,E,1,0,"clr-icon",1),f.YNc(4,y,1,0,"clr-icon",2),f.qZA(),f.TgZ(5,"span",3),f._uU(6),f.qZA()(),f.YNc(7,e,3,2,"clr-tooltip-content",4),f.qZA()),2&l&&(f.xp6(1),f.Udp("max-width",g.labelWidth,"px"),f.s9C("title",g.label.name),f.Q6J("ngStyle",f.kEZ(8,h,null==g.labelColor?null:g.labelColor.color,null==g.labelColor?null:g.labelColor.textColor,"#FFFFFF"===(null==g.labelColor?null:g.labelColor.color)?"1px solid #A1A1A1":"none")),f.xp6(2),f.Q6J("ngIf",g.hasIcon&&"p"===g.label.scope),f.xp6(1),f.Q6J("ngIf",g.hasIcon&&"g"===g.label.scope),f.xp6(2),f.Oqu(g.label.name),f.xp6(1),f.Q6J("ngIf",g.withTooltip&&g.label.description))},dependencies:[v.O5,v.PC,C.qvL,C.MgK,C.Jmj,C.bMv,C.zDF],styles:[".label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:inherit}.label[_ngcontent-%COMP%]   clr-icon[_ngcontent-%COMP%]{margin-right:3px;margin-top:3px}.label-name[_ngcontent-%COMP%]{min-width:0;overflow:hidden;text-overflow:ellipsis}"]}),s})()}}]);