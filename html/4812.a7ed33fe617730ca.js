"use strict";(self.webpackChunkharbor_portal=self.webpackChunkharbor_portal||[]).push([[4812],{4812:(k,y,p)=>{p.r(y),p.d(y,{P2pProviderModule:()=>ot});var g=p(2787),L=p(4554),E=p(3620),A=p(4664),f=p(4716),_=p(1691),T=p(2141),a=p(6921),v=p(8645),x=p(9315),l=p(8280),e=p(5879),u=p(9515),P=p(3419),C=p(4665),h=p(6223),O=p(6814),b=p(927),N=p(4410);function J(n,c){1&n&&(e.TgZ(0,"div",41),e._UZ(1,"span",42),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"REPLICATION.IN_PROGRESS")))}function j(n,c){1&n&&(e.TgZ(0,"div",43),e._UZ(1,"clr-icon",44),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"REPLICATION.SUCCESS")))}function V(n,c){1&n&&(e.TgZ(0,"div",45),e._UZ(1,"clr-icon",46),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"REPLICATION.FAILURE")))}function Y(n,c){1&n&&e._UZ(0,"clr-icon",51)}function F(n,c){if(1&n&&(e.TgZ(0,"clr-tooltip-content",52)(1,"span"),e._uU(2),e.qZA()()),2&n){const o=e.oxw().$implicit;e.Q6J("clrPosition","left"),e.xp6(2),e.Oqu(o.status_message)}}function Q(n,c){if(1&n&&(e.TgZ(0,"a",53),e._UZ(1,"clr-icon",54),e.qZA()),2&n){const o=e.oxw().$implicit,t=e.oxw();e.Q6J("href",t.viewLog(o.id),e.LSH)}}function z(n,c){if(1&n&&(e.TgZ(0,"clr-dg-row",47)(1,"clr-dg-cell"),e._uU(2),e.qZA(),e.TgZ(3,"clr-dg-cell"),e._uU(4),e.qZA(),e.TgZ(5,"clr-dg-cell"),e._uU(6),e.TgZ(7,"clr-tooltip"),e.YNc(8,Y,1,0,"clr-icon",48),e.YNc(9,F,3,2,"clr-tooltip-content",49),e.qZA()(),e.TgZ(10,"clr-dg-cell")(11,"span"),e._uU(12),e.qZA()(),e.TgZ(13,"clr-dg-cell")(14,"span"),e._uU(15),e.qZA()(),e.TgZ(16,"clr-dg-cell")(17,"span"),e._uU(18),e.qZA()(),e.TgZ(19,"clr-dg-cell"),e._uU(20),e.ALo(21,"harborDatetime"),e.qZA(),e.TgZ(22,"clr-dg-cell"),e._uU(23),e.qZA(),e.TgZ(24,"clr-dg-cell"),e.YNc(25,Q,2,1,"a",50),e.qZA()()),2&n){const o=c.$implicit,t=e.oxw();e.Q6J("clrDgItem",o),e.xp6(2),e.Oqu(o.id),e.xp6(2),e.Oqu(o.execution_id),e.xp6(2),e.hij("",o.status," "),e.xp6(2),e.Q6J("ngIf",o.status_message),e.xp6(4),e.Oqu(null==o.extra_attrs?null:o.extra_attrs.artifact),e.xp6(3),e.Oqu(null==o.extra_attrs?null:o.extra_attrs.digest),e.xp6(3),e.Oqu(null==o.extra_attrs?null:o.extra_attrs.kind),e.xp6(2),e.Oqu(e.xi3(21,11,o.start_time,"short")),e.xp6(3),e.Oqu(t.getDuration(o)),e.xp6(2),e.Q6J("ngIf","Initialized"!==o.status)}}function H(n,c){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){e.oxw();const o=e.MAs(125);e.xp6(1),e.lnq("",o.firstItem+1," - ",o.lastItem+1," ",e.lcZ(2,3,"REPLICATION.OF"),"")}}const G=function(){return[15,25,50]};let B=(()=>{var n;class c{constructor(t,i,r,s,d,m,R){this.translate=t,this.router=i,this.route=r,this.messageHandlerService=s,this.preheatService=d,this.p2pProviderService=m,this.userPermissionService=R,this.inProgress=!1,this.currentPage=1,this.pageSize=(0,_.tb)(_.V2.P2P_TASKS_COMPONENT),this.loading=!0,this.hasUpdatePermission=!1,this.btnState=l.xp5.DEFAULT,this._searchSubject=new v.x,this.filterKey="id"}ngOnInit(){this.projectId=+this.route.snapshot.parent.parent.params.id;const t=this.route.snapshot.parent.parent.data;t&&(this.projectName=t.projectResolver.name),this.executionId=this.route.snapshot.params.executionId,this.preheatPolicyName=this.route.snapshot.params.preheatPolicyName,this.executionId&&this.preheatPolicyName&&this.projectName&&this.getExecutionDetail(!0),this.getPermissions(),this.subscribeSearch()}subscribeSearch(){this._searchSubscription||(this._searchSubscription=this._searchSubject.pipe((0,E.b)(500),(0,A.w)(t=>{let i;return this.loading=!0,this.searchString&&(i=encodeURIComponent(`${this.filterKey}=~${t}`)),this.preheatService.ListTasksResponse({projectName:this.projectName,preheatPolicyName:this.preheatPolicyName,executionId:+this.executionId,page:this.currentPage,pageSize:this.pageSize,q:i}).pipe((0,f.x)(()=>this.loading=!1))})).subscribe(t=>{if(t.headers){let i=t.headers.get("x-total-count");i&&(this.totalCount=parseInt(i,0))}this.tasks=t.body,this.setLoop()}))}ngOnDestroy(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.timeoutForTaskList&&(clearTimeout(this.timeoutForTaskList),this.timeoutForTaskList=null),this._searchSubscription&&(this._searchSubscription.unsubscribe(),this._searchSubscription=null)}getPermissions(){const t=[];t.push(this.userPermissionService.getPermission(this.projectId,T._W.P2P_PROVIDER.KEY,T._W.P2P_PROVIDER.VALUE.UPDATE)),this.btnState=l.xp5.LOADING,(0,x.D)(...t).subscribe(i=>{[this.hasUpdatePermission]=i,this.btnState=l.xp5.SUCCESS},i=>{this.messageHandlerService.error(i),this.btnState=l.xp5.ERROR})}getExecutionDetail(t){t&&(this.inProgress=!0),this.executionId&&this.preheatService.GetExecution({projectName:this.projectName,preheatPolicyName:this.preheatPolicyName,executionId:+this.executionId}).pipe((0,f.x)(()=>this.inProgress=!1)).subscribe(i=>{this.execution=i,(!this.execution||this.p2pProviderService.willChangStatus(this.execution.status))&&(this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.timeout||(this.timeout=setTimeout(()=>{this.getExecutionDetail(!1)},a.X8)))},i=>{this.messageHandlerService.error(i)})}trigger(){return this.execution&&this.execution.trigger?this.execution.trigger:""}startTime(){return this.execution&&this.execution.start_time?this.execution.start_time:null}successNum(){return this.execution&&this.execution.metrics&&this.execution.metrics.success_task_count?this.execution.metrics.success_task_count:0}failedNum(){return this.execution&&this.execution.metrics&&this.execution.metrics.error_task_count?this.execution.metrics.error_task_count:0}progressNum(){return this.execution&&this.execution.metrics&&(this.execution.metrics.pending_task_count?this.execution.metrics.pending_task_count:0)+(this.execution.metrics.running_task_count?this.execution.metrics.running_task_count:0)+(this.execution.metrics.scheduled_task_count?this.execution.metrics.scheduled_task_count:0)||0}stoppedNum(){return this.execution&&this.execution.metrics&&this.execution.metrics.stopped_task_count?this.execution.metrics.stopped_task_count:0}stopJob(){this.stopOnGoing=!0;const t=(0,_.d9)(this.execution);t.status=a.r9.STOPPED,this.preheatService.StopExecution({projectName:this.projectName,preheatPolicyName:this.preheatPolicyName,executionId:+this.executionId,execution:t}).subscribe(i=>{this.stopOnGoing=!1,this.getExecutionDetail(!0),this.translate.get("REPLICATION.STOP_SUCCESS",{param:this.executionId}).subscribe(r=>{this.messageHandlerService.showSuccess(r)})},i=>{this.messageHandlerService.error(i)})}viewLog(t){return this.preheatService.rootUrl+`/projects/${this.projectName}/preheat/policies/${this.preheatPolicyName}/executions/${this.executionId}/tasks/${t}/logs`}clrLoadTasks(t,i){let r;t&&(this.loading=!0),i&&i.page&&(this.pageSize=i.page.size,(0,_.Pe)(_.V2.P2P_TASKS_COMPONENT,this.pageSize)),this.searchString&&(r=encodeURIComponent(`${this.filterKey}=~${this.searchString}`)),this.preheatService.ListTasksResponse({projectName:this.projectName,preheatPolicyName:this.preheatPolicyName,executionId:+this.executionId,page:this.currentPage,pageSize:this.pageSize,q:r}).pipe((0,f.x)(()=>{this.loading=!1})).subscribe(s=>{if(s.headers){let d=s.headers.get("x-total-count");d&&(this.totalCount=parseInt(d,0))}this.tasks=s.body,this.setLoop()},s=>{this.messageHandlerService.error(s)})}refreshTasks(){this.currentPage=1,this.totalCount=0,this.clrLoadTasks(!0)}getDuration(t){return this.p2pProviderService.getDuration(t.start_time,t.end_time)}isInProgress(){return this.execution&&this.p2pProviderService.willChangStatus(this.execution.status)}isSuccess(){return this.execution&&this.execution.status===a.r9.SUCCESS}isFailed(){return this.execution&&(this.execution.status===a.r9.ERROR||this.execution.status===a.r9.STOPPED)}canStop(){return this.execution&&this.p2pProviderService.willChangStatus(this.execution.status)}setLoop(){if(this.timeoutForTaskList&&(clearTimeout(this.timeoutForTaskList),this.timeoutForTaskList=null),this.tasks&&this.tasks.length)for(let t=0;t<this.tasks.length;t++)this.p2pProviderService.willChangStatus(this.tasks[t].status)&&(this.timeoutForTaskList||(this.timeoutForTaskList=setTimeout(()=>{this.clrLoadTasks(!1)},a.X8)))}selectFilterKey(t){this.filterKey=t.target.value}doFilter(t){this.searchString=t,t.trim()?this._searchSubject.next(t.trim()):this.clrLoadTasks(!0)}openFilter(t){this.isOpenFilterTag=t}}return(n=c).\u0275fac=function(t){return new(t||n)(e.Y36(u.sK),e.Y36(g.F0),e.Y36(g.gz),e.Y36(P.d),e.Y36(C.L),e.Y36(a.YQ),e.Y36(T.Hx))},n.\u0275cmp=e.Xpm({type:n,selectors:[["task-list"]],decls:132,vars:111,consts:[[1,"replication-tasks","mt-2"],[1,"overview-section"],[1,"title-wrapper"],[1,"title-block"],[1,"custom-h2","h2-style"],[1,"id-divider"],[1,"margin-top-16px"],["class","status-progress",4,"ngIf"],["class","status-success",4,"ngIf"],["class","status-failed",4,"ngIf"],[1,"button-stop"],[1,"btn","btn-primary",3,"disabled","click"],[1,"spinner","spinner-inline",3,"hidden"],[1,"execution-block"],[1,"executions-detail"],[1,"flex-block"],[1,"execution-detail-label"],[1,"detail-row"],[1,"num-success","common-style"],[1,"detail-span"],[1,"execution-details"],[1,"num-failed","common-style"],[1,"num-progress","common-style"],[1,"num-stopped","common-style"],[1,"tasks-detail"],[1,"modal-title"],[3,"clrDgLoading","clrDgRefresh"],[1,"row","flex-end"],[1,"select","filter-tag","clr-select-wrapper",3,"hidden"],["id","selectKey",3,"change"],["value","id"],["value","execution_id"],["value","status"],["id","filter-executions",3,"currentValue","withDivider","filterPlaceholder","filterEvt","openFlag"],[1,"refresh-btn"],["shape","refresh",3,"hidden","click"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgPage","clrDgPageSize","clrDgTotalItems","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[4,"ngIf"],[1,"status-progress"],[1,"spinner","spinner-inline"],[1,"status-success"],["size","18","shape","success-standard",1,"color-green"],[1,"status-failed"],["size","18","shape","error-standard",1,"color-red"],[3,"clrDgItem"],["clrTooltipTrigger","","shape","info-circle","size","20",4,"ngIf"],["clrSize","md",3,"clrPosition",4,"clrIfOpen"],["rel","noopener noreferrer","target","_blank",3,"href",4,"ngIf"],["clrTooltipTrigger","","shape","info-circle","size","20"],["clrSize","md",3,"clrPosition"],["rel","noopener noreferrer","target","_blank",3,"href"],["shape","list"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"section",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"h2",4),e._uU(7),e.ALo(8,"translate"),e.qZA(),e._UZ(9,"span",5),e.TgZ(10,"h2",4),e._uU(11),e.qZA()(),e.TgZ(12,"div",6),e.YNc(13,J,5,3,"div",7),e.YNc(14,j,5,3,"div",8),e.YNc(15,V,5,3,"div",9),e.qZA(),e.TgZ(16,"div",10)(17,"button",11),e.NdJ("click",function(){return i.stopJob()}),e._uU(18),e.ALo(19,"translate"),e.qZA(),e._UZ(20,"span",12),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14)(23,"div")(24,"label"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"span"),e._uU(28),e.ALo(29,"translate"),e.qZA()(),e.TgZ(30,"div")(31,"label"),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"span"),e._uU(35),e.ALo(36,"harborDatetime"),e.qZA()()(),e.TgZ(37,"div",15)(38,"section",16)(39,"section",17),e._UZ(40,"div",18),e.TgZ(41,"label",19),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"div",20),e._uU(45),e.qZA()(),e.TgZ(46,"section",17),e._UZ(47,"div",21),e.TgZ(48,"label",19),e._uU(49),e.ALo(50,"translate"),e.qZA(),e.TgZ(51,"div",20),e._uU(52),e.qZA()(),e.TgZ(53,"section",17),e._UZ(54,"div",22),e.TgZ(55,"label",19),e._uU(56),e.ALo(57,"translate"),e.qZA(),e.TgZ(58,"div",20),e._uU(59),e.qZA()(),e.TgZ(60,"section",17),e._UZ(61,"div",23),e.TgZ(62,"label",19),e._uU(63),e.ALo(64,"translate"),e.qZA(),e.TgZ(65,"div",20),e._uU(66),e.qZA()()()()()(),e.TgZ(67,"div",24)(68,"h3",25),e._uU(69),e.ALo(70,"translate"),e.qZA(),e.TgZ(71,"clr-datagrid",26),e.NdJ("clrDgRefresh",function(s){return i.clrLoadTasks(!0,s)}),e.TgZ(72,"clr-dg-action-bar")(73,"div",27)(74,"div",28)(75,"select",29),e.NdJ("change",function(s){return i.selectFilterKey(s)}),e.TgZ(76,"option",30),e._uU(77),e.ALo(78,"lowercase"),e.ALo(79,"translate"),e.qZA(),e.TgZ(80,"option",31),e._uU(81),e.ALo(82,"lowercase"),e.ALo(83,"translate"),e.qZA(),e.TgZ(84,"option",32),e._uU(85),e.ALo(86,"lowercase"),e.ALo(87,"translate"),e.qZA()()(),e.TgZ(88,"hbr-filter",33),e.NdJ("filterEvt",function(s){return i.doFilter(s)})("openFlag",function(s){return i.openFilter(s)}),e.ALo(89,"translate"),e.qZA(),e.TgZ(90,"span",34)(91,"clr-icon",35),e.NdJ("click",function(){return i.refreshTasks()}),e.qZA()()()(),e.TgZ(92,"clr-dg-column"),e._uU(93),e.ALo(94,"translate"),e.qZA(),e.TgZ(95,"clr-dg-column"),e._uU(96),e.ALo(97,"translate"),e.qZA(),e.TgZ(98,"clr-dg-column"),e._uU(99),e.ALo(100,"translate"),e.qZA(),e.TgZ(101,"clr-dg-column"),e._uU(102),e.ALo(103,"translate"),e.qZA(),e.TgZ(104,"clr-dg-column"),e._uU(105),e.ALo(106,"translate"),e.qZA(),e.TgZ(107,"clr-dg-column"),e._uU(108),e.ALo(109,"translate"),e.qZA(),e.TgZ(110,"clr-dg-column"),e._uU(111),e.ALo(112,"translate"),e.qZA(),e.TgZ(113,"clr-dg-column"),e._uU(114),e.ALo(115,"translate"),e.qZA(),e.TgZ(116,"clr-dg-column"),e._uU(117),e.ALo(118,"translate"),e.qZA(),e.TgZ(119,"clr-dg-placeholder"),e._uU(120),e.ALo(121,"translate"),e.qZA(),e.YNc(122,z,26,14,"clr-dg-row",36),e.TgZ(123,"clr-dg-footer")(124,"clr-dg-pagination",37,38),e.NdJ("clrDgPageChange",function(s){return i.currentPage=s}),e.TgZ(126,"clr-dg-page-size",39),e._uU(127),e.ALo(128,"translate"),e.qZA(),e.YNc(129,H,3,5,"span",40),e._uU(130),e.ALo(131,"translate"),e.qZA()()()()()),2&t&&(e.xp6(7),e.hij(" ",e.lcZ(8,49,"P2P_PROVIDER.EXECUTIONS")," "),e.xp6(4),e.Oqu(i.executionId),e.xp6(2),e.Q6J("ngIf",i.execution&&i.isInProgress()),e.xp6(1),e.Q6J("ngIf",i.execution&&i.isSuccess()),e.xp6(1),e.Q6J("ngIf",i.execution&&i.isFailed()),e.xp6(2),e.Q6J("disabled",!i.hasUpdatePermission||i.stopOnGoing||!i.canStop()),e.xp6(1),e.hij(" ",e.lcZ(19,51,"REPLICATION.STOPJOB")," "),e.xp6(2),e.Q6J("hidden",!1===i.inProgress),e.xp6(5),e.hij("",e.lcZ(26,53,"REPLICATION.TRIGGER_MODE")," :"),e.xp6(3),e.Oqu(e.lcZ(29,55,i.trigger())),e.xp6(4),e.hij("",e.lcZ(33,57,"REPLICATION.CREATION_TIME")," :"),e.xp6(3),e.Oqu(e.xi3(36,59,i.startTime(),"short")),e.xp6(7),e.Oqu(e.lcZ(43,62,"REPLICATION.SUCCESS")),e.xp6(3),e.Oqu(i.successNum()),e.xp6(4),e.Oqu(e.lcZ(50,64,"REPLICATION.FAILURE")),e.xp6(3),e.Oqu(i.failedNum()),e.xp6(4),e.Oqu(e.lcZ(57,66,"REPLICATION.IN_PROGRESS")),e.xp6(3),e.Oqu(i.progressNum()),e.xp6(4),e.Oqu(e.lcZ(64,68,"REPLICATION.STOPPED")),e.xp6(3),e.Oqu(i.stoppedNum()),e.xp6(3),e.Oqu(e.lcZ(70,70,"P2P_PROVIDER.TASKS")),e.xp6(2),e.Q6J("clrDgLoading",i.loading),e.xp6(3),e.Q6J("hidden",!i.isOpenFilterTag),e.xp6(3),e.hij(" ",e.lcZ(78,72,e.lcZ(79,74,"REPLICATION.TASK_ID"))," "),e.xp6(4),e.hij(" ",e.lcZ(82,76,e.lcZ(83,78,"P2P_PROVIDER.ID"))," "),e.xp6(4),e.hij(" ",e.lcZ(86,80,e.lcZ(87,82,"REPLICATION.STATUS"))," "),e.xp6(3),e.s9C("filterPlaceholder",e.lcZ(89,84,"REPLICATION.FILTER_PLACEHOLDER")),e.Q6J("currentValue",i.searchString)("withDivider",!0),e.xp6(3),e.Q6J("hidden",i.loading),e.xp6(2),e.Oqu(e.lcZ(94,86,"REPLICATION.TASK_ID")),e.xp6(3),e.Oqu(e.lcZ(97,88,"P2P_PROVIDER.ID")),e.xp6(3),e.Oqu(e.lcZ(100,90,"REPLICATION.STATUS")),e.xp6(3),e.Oqu(e.lcZ(103,92,"P2P_PROVIDER.ARTIFACT")),e.xp6(3),e.Oqu(e.lcZ(106,94,"P2P_PROVIDER.DIGEST")),e.xp6(3),e.Oqu(e.lcZ(109,96,"P2P_PROVIDER.TYPE")),e.xp6(3),e.Oqu(e.lcZ(112,98,"REPLICATION.CREATION_TIME")),e.xp6(3),e.Oqu(e.lcZ(115,100,"REPLICATION.DURATION")),e.xp6(3),e.Oqu(e.lcZ(118,102,"REPLICATION.LOGS")),e.xp6(3),e.Oqu(e.lcZ(121,104,"P2P_PROVIDER.TASKS_PLACEHOLDER")),e.xp6(2),e.Q6J("ngForOf",i.tasks),e.xp6(2),e.Q6J("clrDgPage",i.currentPage)("clrDgPageSize",i.pageSize)("clrDgTotalItems",i.totalCount),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(110,G)),e.xp6(1),e.Oqu(e.lcZ(128,106,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",i.totalCount),e.xp6(1),e.AsE(" ",i.totalCount," ",e.lcZ(131,108,"REPLICATION.ITEMS")," "))},dependencies:[h.YN,h.Kr,l.C9t,l.Gwl,l.fv_,l.m4W,l.dRQ,l.YYR,l.Ltv,l.F7K,l.Z4N,l.jND,l.KHL,l.PDs,l.Gcc,l.dml,l.Nh1,l.K8c,l.qvL,l.nqY,l.MgK,l.Jmj,l.bMv,l.zDF,O.sg,O.O5,b.z,u.X$,O.i8,N.Z],styles:[".replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .title-wrapper[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%]{display:flex;align-items:center}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .title-wrapper[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{min-width:250px;margin-right:5px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .title-wrapper[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){width:140px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .title-wrapper[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2)   span[_ngcontent-%COMP%]{color:#007cbb;font-size:12px;margin-left:10px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .title-wrapper[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%]   .id-divider[_ngcontent-%COMP%]{display:inline-block;height:25px;width:2px;background-color:#ccc;margin:0 20px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .title-wrapper[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%]   .h2-style[_ngcontent-%COMP%]{display:inline-block}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]{margin-top:24px;display:flex;flex-wrap:wrap}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]{margin-right:10px;text-align:left}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;height:27px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .common-style[_ngcontent-%COMP%]{width:12px;height:12px;margin-top:16px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .num-success[_ngcontent-%COMP%]{background-color:#308700}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .num-failed[_ngcontent-%COMP%]{background-color:#c92101}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .num-progress[_ngcontent-%COMP%]{background-color:#1c5898}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .num-stopped[_ngcontent-%COMP%]{background-color:#a1a1a1}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-span[_ngcontent-%COMP%]{flex:0 0 100px;margin:10px 0 0 10px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .execution-detail-label[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .execution-details[_ngcontent-%COMP%]{width:200px;margin:8px 35px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .executions-detail[_ngcontent-%COMP%]{width:391px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .executions-detail[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;width:120px}.replication-tasks[_ngcontent-%COMP%]   .overview-section[_ngcontent-%COMP%]   .execution-block[_ngcontent-%COMP%]   .executions-detail[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-top:10px}.replication-tasks[_ngcontent-%COMP%]   .tasks-detail[_ngcontent-%COMP%]{margin-top:65px}.replication-tasks[_ngcontent-%COMP%]   .tasks-detail[_ngcontent-%COMP%]   .action-select[_ngcontent-%COMP%]{padding-right:18px;height:24px;display:flex;justify-content:flex-end}.replication-tasks[_ngcontent-%COMP%]   .tasks-detail[_ngcontent-%COMP%]   .action-select[_ngcontent-%COMP%]   .filter-tag[_ngcontent-%COMP%]{float:left;margin-top:8px}.replication-tasks[_ngcontent-%COMP%]   .tasks-detail[_ngcontent-%COMP%]   .action-select[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%]{cursor:pointer;margin-top:7px}.replication-tasks[_ngcontent-%COMP%]   .tasks-detail[_ngcontent-%COMP%]   .action-select[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%]:hover{color:#007cbb}.replication-tasks[_ngcontent-%COMP%]   .tasks-detail[_ngcontent-%COMP%]   clr-datagrid[_ngcontent-%COMP%]   .resource-width[_ngcontent-%COMP%]{width:150px}.margin-top-16px[_ngcontent-%COMP%]{margin-top:16px}.flex-end[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:flex-end;padding-right:1.5rem}.refresh-btn[_ngcontent-%COMP%]{margin-top:6px;cursor:pointer}.filter-tag[_ngcontent-%COMP%]{margin-top:7px}.button-stop[_ngcontent-%COMP%]{margin-top:16px;margin-left:-5px}"]}),c})();var K=p(3997),$=p(2181),M=p(208),X=p(1575),W=p(6682),ee=p(575);const te=["policyForm"],ie=["cronScheduleComponent"];function ne(n,c){1&n&&(e.TgZ(0,"h3",4),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"P2P_PROVIDER.EDIT_POLICY")," "))}function oe(n,c){1&n&&(e.TgZ(0,"h3",4),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"P2P_PROVIDER.ADD_POLICY")," "))}function re(n,c){if(1&n&&(e.TgZ(0,"option",45),e._uU(1),e.qZA()),2&n){const o=c.$implicit,t=e.oxw();e.s9C("value",o.id),e.Q6J("selected",t.policy.provider_id===o.id),e.xp6(1),e.hij(" ",o.provider," ")}}function se(n,c){1&n&&(e.TgZ(0,"clr-control-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"P2P_PROVIDER.PROVIDER_REQUIRED")," "))}function le(n,c){1&n&&(e.TgZ(0,"span",51),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"P2P_PROVIDER.NO_PROVIDER")))}function ce(n,c){1&n&&(e.TgZ(0,"span",51),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"P2P_PROVIDER.NEED_HELP")))}function ae(n,c){1&n&&(e.TgZ(0,"a",52),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"P2P_PROVIDER.PROVIDER")))}function pe(n,c){if(1&n&&(e.TgZ(0,"div",46),e._UZ(1,"label",41),e.TgZ(2,"div",47)(3,"div",48),e.YNc(4,le,3,3,"span",49),e.YNc(5,ce,3,3,"span",49),e.YNc(6,ae,3,3,"a",50),e.qZA()()()),2&n){const o=e.oxw();e.xp6(4),e.Q6J("ngIf",o.isSystemAdmin()),e.xp6(1),e.Q6J("ngIf",!o.isSystemAdmin()),e.xp6(1),e.Q6J("ngIf",o.isSystemAdmin())}}function de(n,c){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SCANNER.NAME_EXISTS")))}function ge(n,c){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"P2P_PROVIDER.NAME_TOOLTIP")))}function _e(n,c){if(1&n&&(e.TgZ(0,"clr-control-error"),e.YNc(1,de,3,3,"span",13),e.YNc(2,ge,3,3,"span",13),e.qZA()),2&n){const o=e.oxw(),t=e.MAs(26);e.xp6(1),e.Q6J("ngIf",!((t.dirty||t.touched)&&t.invalid)&&o.isNameExisting),e.xp6(1),e.Q6J("ngIf",(t.dirty||t.touched)&&t.invalid)}}function ue(n,c){1&n&&(e.TgZ(0,"clr-control-error",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"P2P_PROVIDER.REPO_REQUIRED")," "))}function he(n,c){1&n&&(e.TgZ(0,"clr-control-error",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"P2P_PROVIDER.TAG_REQUIRED")," "))}function Pe(n,c){1&n&&(e.TgZ(0,"clr-tooltip-content",60),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"P2P_PROVIDER.CRITERIA_EXPLAIN")," "))}function me(n,c){if(1&n){const o=e.EpF();e.TgZ(0,"div",32)(1,"label",41)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"clr-tooltip"),e._UZ(6,"clr-icon",54),e.YNc(7,Pe,3,3,"clr-tooltip-content",55),e.qZA()(),e.TgZ(8,"div",56)(9,"div",57)(10,"input",58),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.onlySignedImages=i)}),e.qZA(),e.TgZ(11,"label",59),e._uU(12),e.ALo(13,"translate"),e.qZA()()()()}if(2&n){const o=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,3,"P2P_PROVIDER.CRITERIA")),e.xp6(7),e.Q6J("ngModel",o.onlySignedImages),e.xp6(2),e.Oqu(e.lcZ(13,5,"P2P_PROVIDER.ONLY_SIGNED"))}}function fe(n,c){1&n&&(e.TgZ(0,"clr-tooltip-content",60),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"P2P_PROVIDER.CRITERIA_EXPLAIN")," "))}function Te(n,c){1&n&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"clr-tooltip"),e._UZ(5,"clr-icon",67),e.YNc(6,fe,3,3,"clr-tooltip-content",55),e.qZA(),e.BQk()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"P2P_PROVIDER.CRITERIA")))}function xe(n,c){if(1&n&&(e.TgZ(0,"option",45),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const o=c.$implicit,t=e.oxw(2);e.s9C("value",o.severity),e.Q6J("selected",t.severity===o.severity),e.xp6(1),e.hij(" ",e.lcZ(2,3,o.severityLevel)," ")}}function Ce(n,c){if(1&n){const o=e.EpF();e.TgZ(0,"div",61)(1,"label",26),e.YNc(2,Te,7,3,"ng-container",13),e.qZA(),e.TgZ(3,"div",62)(4,"label",63),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",64)(8,"select",65,66),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.severity=i)}),e.TgZ(10,"option"),e._uU(11,"--"),e.qZA(),e.YNc(12,xe,3,5,"option",12),e.qZA()(),e.TgZ(13,"label",63),e._uU(14),e.ALo(15,"translate"),e.qZA()()()}if(2&n){const o=e.oxw();e.xp6(2),e.Q6J("ngIf",!o.enableContentTrust),e.xp6(3),e.hij("",e.lcZ(6,5,"P2P_PROVIDER.START_TEXT"),"\xa0"),e.xp6(3),e.Q6J("ngModel",o.severity),e.xp6(4),e.Q6J("ngForOf",o.severityOptions),e.xp6(2),e.hij("\xa0",e.lcZ(15,7,"P2P_PROVIDER.EDN_TEXT"),"")}}function Oe(n,c){if(1&n&&(e.TgZ(0,"option",45),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const o=c.$implicit,t=e.oxw();e.s9C("value",o),e.Q6J("selected",t.triggerType===o),e.xp6(1),e.hij(" ",e.lcZ(2,3,t.getTriggerTypeI18n(o))," ")}}function Ae(n,c){1&n&&(e.TgZ(0,"clr-tooltip-content",70)(1,"div"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.ALo(12,"translate"),e.qZA()()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,4,"P2P_PROVIDER.EVENT_BASED_EXPLAIN_LINE1")," "),e.xp6(3),e.hij(" ",e.lcZ(6,6,"P2P_PROVIDER.EVENT_BASED_EXPLAIN_LINE2")," "),e.xp6(3),e.hij(" ",e.lcZ(9,8,"P2P_PROVIDER.EVENT_BASED_EXPLAIN_LINE3")," "),e.xp6(3),e.hij(" ",e.lcZ(12,10,"P2P_PROVIDER.EVENT_BASED_EXPLAIN_LINE4")," "))}function Ze(n,c){1&n&&(e.TgZ(0,"clr-tooltip"),e._UZ(1,"clr-icon",68),e.YNc(2,Ae,13,12,"clr-tooltip-content",69),e.qZA())}function Ee(n,c){if(1&n){const o=e.EpF();e.TgZ(0,"div",32),e._UZ(1,"label",26),e.TgZ(2,"div",17)(3,"cron-selection",71,72),e.NdJ("inputvalue",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.setCron(i))}),e.qZA()()()}if(2&n){const o=e.oxw();e.xp6(3),e.Q6J("isInlineModel",!0)("originCron",o.getCron())}}function ve(n,c){if(1&n){const o=e.EpF();e.TgZ(0,"div",73)(1,"button",74),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.onCancel())}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",75),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.addOrSave(!0))}),e._uU(5),e.ALo(6,"translate"),e.qZA()()}if(2&n){const o=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,4,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("clrLoading",o.buttonStatus)("disabled",o.isNameExisting||o.checkNameOnGoing||o.loading||!o.valid()),e.xp6(1),e.hij(" ",e.lcZ(6,6,"BUTTON.ADD")," ")}}function ye(n,c){if(1&n){const o=e.EpF();e.TgZ(0,"div",73)(1,"button",76),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.onCancel())}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",77),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.addOrSave(!1))}),e._uU(5),e.ALo(6,"translate"),e.qZA()()}if(2&n){const o=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,4,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("clrLoading",o.buttonStatus)("disabled",o.isNameExisting||o.checkNameOnGoing||o.loading||!o.valid()||!o.hasChange()),e.xp6(1),e.hij(" ",e.lcZ(6,6,"BUTTON.SAVE")," ")}}const D="true";let U=(()=>{var n;class c{constructor(t,i,r,s,d){this.preheatService=t,this.session=i,this.route=r,this.appConfigService=s,this.projectService=d,this.severityOptions=[{severity:5,severityLevel:"VULNERABILITY.SEVERITY.CRITICAL"},{severity:4,severityLevel:"VULNERABILITY.SEVERITY.HIGH"},{severity:3,severityLevel:"VULNERABILITY.SEVERITY.MEDIUM"},{severity:2,severityLevel:"VULNERABILITY.SEVERITY.LOW"},{severity:0,severityLevel:"VULNERABILITY.SEVERITY.NONE"}],this.isOpen=!1,this.closable=!1,this.staticBackdrop=!0,this.notify=new e.vpe,this.policy={},this.onlySignedImages=!1,this.triggerType=a.pA.MANUAL,this.loading=!1,this.buttonStatus=l.xp5.DEFAULT,this.providers=[],this.preventVul=!1,this.triggers=[a.pA.MANUAL,a.pA.SCHEDULED,a.pA.EVENT_BASED],this.enableContentTrust=!1,this._nameSubject=new v.x,this.isNameExisting=!1,this.checkNameOnGoing=!1,this.hasInit=new e.vpe}ngOnInit(){const t=this.route.snapshot.parent.parent.data;if(t){const i=t.projectResolver;this.projectName=i.name,this.projectId=i.project_id,this.getProject()}this.subscribeName()}ngOnDestroy(){this._nameSubscription&&(this._nameSubscription.unsubscribe(),this._nameSubscription=null)}subscribeName(){this._nameSubscription||(this._nameSubscription=this._nameSubject.pipe((0,E.b)(500),(0,K.x)(),(0,$.h)(t=>(!this.isEdit||!this.originPolicyForEdit||this.originPolicyForEdit.name!==t)&&t.length>0),(0,A.w)(t=>(this.isNameExisting=!1,this.checkNameOnGoing=!0,this.preheatService.ListPolicies({projectName:this.projectName,q:encodeURIComponent(`name=${t}`)}).pipe((0,f.x)(()=>this.checkNameOnGoing=!1))))).subscribe(t=>{t&&t.length>0&&(this.isNameExisting=!0)}))}inputName(){this._nameSubject.next(this.policy.name)}getProject(){this.projectService.getProject(this.projectId).subscribe(t=>{t&&t.metadata&&(this.preventVul=t.metadata.prevent_vul===D,this.projectSeverity=t.metadata.severity,this.enableContentTrust=t.metadata.enable_content_trust_cosign===D,this.severity=a.Yt[this.projectSeverity]),this.hasInit.emit(!0)})}resetForAdd(){this.inlineAlert.close(),this.policy={},this.repos=null,this.tags=null,this.labels=null,this.cron=null,this.isNameExisting=!1,this.providers&&this.providers.length&&this.providers.forEach(t=>{t.default&&(this.policy.provider_id=t.id)}),this.currentForm.reset({triggerType:"manual",severity:a.Yt[this.projectSeverity],onlySignedImages:this.enableContentTrust,provider:this.policy.provider_id})}setCron(t){this.cron=t,this.cronScheduleComponent.resetSchedule()}getCron(){const t={type:"None",cron:""};return t.cron=this.cron,t.type=""===t.cron||null==t.cron?"None":"0 0 * * * *"===t.cron?"Hourly":"0 0 0 * * *"===t.cron?"Daily":"0 0 0 * * 0"===t.cron?"Weekly":"Custom",t}onCancel(){this.isOpen=!1}closeModal(){this.isOpen=!1}addOrSave(t){const i={};Object.assign(i,this.policy),i.provider_id=+i.provider_id;const r=[];this.repos&&(-1!==this.repos.indexOf(",")&&-1===this.repos.indexOf("{")&&-1===this.repos.indexOf("}")?r.push({type:a.kQ.REPOS,value:`{${this.repos}}`}):r.push({type:a.kQ.REPOS,value:this.repos})),this.tags&&(-1!==this.tags.indexOf(",")&&-1===this.tags.indexOf("{")&&-1===this.tags.indexOf("}")?r.push({type:a.kQ.TAG,value:`{${this.tags}}`}):r.push({type:a.kQ.TAG,value:this.tags})),this.labels&&(-1!==this.labels.indexOf(",")&&-1===this.labels.indexOf("{")&&-1===this.labels.indexOf("}")?r.push({type:a.kQ.LABEL,value:`{${this.labels}}`}):r.push({type:a.kQ.LABEL,value:this.labels})),i.filters=JSON.stringify(r),i.trigger=JSON.stringify({type:this.triggerType?this.triggerType:a.pA.MANUAL,trigger_setting:{cron:this.triggerType&&this.triggerType!==a.pA.MANUAL&&this.triggerType!==a.pA.EVENT_BASED?this.cron:""}}),this.loading=!0,this.buttonStatus=l.xp5.LOADING,(0,_.Xl)(i),t?(i.project_id=this.projectId,i.enabled=!0,this.preheatService.CreatePolicy({projectName:this.projectName,policy:i}).pipe((0,f.x)(()=>this.loading=!1)).subscribe(d=>{this.buttonStatus=l.xp5.SUCCESS,this.closeModal(),this.notify.emit(t)},d=>{this.inlineAlert.showInlineError(d),this.buttonStatus=l.xp5.ERROR})):(i.id=this.originPolicyForEdit.id,this.preheatService.UpdatePolicy({projectName:this.projectName,preheatPolicyName:this.originPolicyForEdit.name,policy:i}).pipe((0,f.x)(()=>this.loading=!1)).subscribe(d=>{this.buttonStatus=l.xp5.SUCCESS,this.closeModal(),this.notify.emit(t)},d=>{this.inlineAlert.showInlineError(d),this.buttonStatus=l.xp5.ERROR}))}valid(){return!(this.triggerType===a.pA.SCHEDULED&&!this.cron)&&this.currentForm.valid}compare(){return!!(this.projectSeverity&&this.preventVul&&a.Yt[this.projectSeverity]>(this.severity?this.severity:0))}hasChange(){return!(this.policy.provider_id==this.originPolicyForEdit.provider_id&&this.policy.name==this.originPolicyForEdit.name&&(!this.policy.description&&!this.originPolicyForEdit.description||this.policy.description==this.originPolicyForEdit.description)&&this.originReposForEdit==this.repos&&this.originTagsForEdit==this.tags&&this.originOnlySignedImagesForEdit==this.onlySignedImages&&this.originLabelsForEdit==this.labels&&this.originSeverityForEdit==this.severity&&this.originTriggerTypeForEdit==this.triggerType)||this.originCronForEdit!=this.cron}isSystemAdmin(){const t=this.session.getCurrentUser();return null!=t&&t.has_admin_role}getTriggerTypeI18n(t){return t?a.E3[t]:""}showCron(){return!!this.triggerType&&this.triggerType===a.pA.SCHEDULED}showExplainForEventBased(){return this.triggerType===a.pA.EVENT_BASED}}return(n=c).\u0275fac=function(t){return new(t||n)(e.Y36(C.L),e.Y36(X.m),e.Y36(g.gz),e.Y36(W._),e.Y36(T.Y4))},n.\u0275cmp=e.Xpm({type:n,selectors:[["add-p2p-policy"]],viewQuery:function(t,i){if(1&t&&(e.Gf(M.l,5),e.Gf(te,7),e.Gf(ie,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.inlineAlert=r.first),e.iGM(r=e.CRH())&&(i.currentForm=r.first),e.iGM(r=e.CRH())&&(i.cronScheduleComponent=r.first)}},inputs:{providers:"providers"},outputs:{notify:"notify",hasInit:"hasInit"},decls:91,vars:71,consts:[[3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],["class","modal-title",4,"ngIf"],[1,"modal-body"],[1,"align-center"],[1,"modal-title"],[1,"clr-form","clr-form-horizontal"],["policyForm","ngForm"],[1,"form-block"],[1,"clr-control-label","required","width-6rem"],["clrSelect","","name","provider","id","provider","required","",1,"width-380",3,"disabled","ngModel","ngModelChange"],["provider","ngModel"],["value","",1,"display-none"],[3,"selected","value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","clr-form-control mt-0",4,"ngIf"],[1,"clr-form-control"],["for","name",1,"clr-control-label","required","width-6rem"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["pattern","^[A-Za-z0-9]+(?:[._-][A-Za-z0-9]+)*$","autocomplete","off","type","text","id","name","size","30","name","name","required","",1,"clr-input","width-380",3,"disabled","ngModel","ngModelChange","input"],["name","ngModel"],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"spinner","spinner-inline",3,"hidden"],["for","description",1,"clr-control-label","width-6rem"],["autocomplete","off","type","text","id","description","name","description",1,"clr-textarea","width-380",3,"disabled","ngModel","ngModelChange"],["description","ngModel"],["for","repo",1,"clr-control-label","width-6rem"],[1,"sub-label","required"],["placeholder","**","autocomplete","off","type","text","id","repo","size","30","name","repo","required","",1,"clr-input","width-290",3,"disabled","ngModel","ngModelChange"],["repo","ngModel"],[1,"margin-left-90px","opacity-08"],["class","margin-left-90px",4,"ngIf"],[1,"clr-form-control","margin-top-06"],["for","repo",1,"width-6rem"],["placeholder","**","autocomplete","off","type","text","id","tag","size","30","name","tag","required","",1,"clr-input","width-290",3,"disabled","ngModel","ngModelChange"],["tag","ngModel"],[1,"sub-label"],["autocomplete","off","type","text","id","labels","size","30","name","label",1,"clr-input","width-290",3,"disabled","ngModel","ngModelChange"],["class","clr-form-control margin-top-06",4,"ngIf"],["class","clr-form-control margin-top-06 mt-1",4,"ngIf"],[1,"flex","baseline"],[1,"clr-control-label","width-6rem"],["clrSelect","","name","triggerType","id","trigger-type",1,"width-380",3,"disabled","ngModel","ngModelChange"],["ngTriggerType","ngModel"],["class","mt-1 bottom-btn",4,"ngIf"],[3,"selected","value"],[1,"clr-form-control","mt-0"],[1,"clr-control-container","width-380"],[1,"space-between"],["class","alert-label",4,"ngIf"],["class","go-link","routerLink","/harbor/distribution/instances",4,"ngIf"],[1,"alert-label"],["routerLink","/harbor/distribution/instances",1,"go-link"],[1,"margin-left-90px"],["clrTooltipTrigger","","shape","info-circle","size","24",1,"cri-tooltip"],["clrPosition","top-left","clrSize","lg",4,"clrIfOpen"],[1,"clr-control-container","opacity-054"],[1,"clr-checkbox-wrapper"],["disabled","","type","checkbox","id","onlySignedImages","name","onlySignedImages",1,"clr-checkbox",3,"ngModel","ngModelChange"],["for","onlySignedImages",1,"font-size-12"],["clrPosition","top-left","clrSize","lg"],[1,"clr-form-control","margin-top-06","mt-1"],[1,"clr-control-container","flex"],[1,"sub-text","opacity-054"],[1,"clr-select-wrapper"],["disabled","","id","severity","name","severity",1,"clr-select",3,"ngModel","ngModelChange"],["ngSeverity","ngModel"],["clrTooltipTrigger","","shape","info-circle","size","24",1,"tooltip"],["clrTooltipTrigger","","shape","info-circle","size","24"],["clrPosition","top-right","clrSize","lg",4,"clrIfOpen"],["clrPosition","top-right","clrSize","lg"],[3,"isInlineModel","originCron","inputvalue"],["cronScheduleComponent",""],[1,"mt-1","bottom-btn"],["type","button","id","add-policy-cancel",1,"btn","btn-outline",3,"click"],["type","button","id","new-policy",1,"btn","btn-primary",3,"clrLoading","disabled","click"],["type","button","id","edit-policy-cancel",1,"btn","btn-outline",3,"click"],["type","button","id","edit-policy-save",1,"btn","btn-primary",3,"clrLoading","disabled","click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(s){return i.isOpen=s}),e.YNc(1,ne,3,3,"h3",1),e.YNc(2,oe,3,3,"h3",1),e.TgZ(3,"div",2)(4,"div",3),e._UZ(5,"inline-alert",4),e.TgZ(6,"form",5,6)(8,"section",7)(9,"clr-select-container")(10,"label",8),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"select",9,10),e.NdJ("ngModelChange",function(s){return i.policy.provider_id=s}),e._UZ(15,"option",11),e.YNc(16,re,2,3,"option",12),e.qZA(),e.YNc(17,se,3,3,"clr-control-error",13),e.qZA(),e.YNc(18,pe,7,3,"div",14),e.TgZ(19,"div",15)(20,"label",16),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"div",17)(24,"div",18)(25,"input",19,20),e.NdJ("ngModelChange",function(s){return i.policy.name=s})("input",function(){return i.inputName()}),e.qZA(),e._UZ(27,"clr-icon",21)(28,"span",22),e.qZA(),e.YNc(29,_e,3,2,"clr-control-error",13),e.qZA()(),e.TgZ(30,"div",15)(31,"label",23),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"div",17)(35,"textarea",24,25),e.NdJ("ngModelChange",function(s){return i.policy.description=s}),e.qZA()()(),e.TgZ(37,"div",15)(38,"label",26),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"div",17)(42,"div",18)(43,"label",27),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.TgZ(46,"input",28,29),e.NdJ("ngModelChange",function(s){return i.repos=s}),e.qZA(),e._UZ(48,"clr-icon",21),e.qZA(),e.TgZ(49,"clr-control-helper",30),e._uU(50),e.ALo(51,"translate"),e.qZA(),e.YNc(52,ue,3,3,"clr-control-error",31),e.qZA()(),e.TgZ(53,"div",32),e._UZ(54,"label",33),e.TgZ(55,"div",17)(56,"div",18)(57,"label",27),e._uU(58),e.ALo(59,"translate"),e.qZA(),e.TgZ(60,"input",34,35),e.NdJ("ngModelChange",function(s){return i.tags=s}),e.qZA(),e._UZ(62,"clr-icon",21),e.qZA(),e.TgZ(63,"clr-control-helper",30),e._uU(64),e.ALo(65,"translate"),e.qZA(),e.YNc(66,he,3,3,"clr-control-error",31),e.qZA()(),e.TgZ(67,"div",32),e._UZ(68,"label",26),e.TgZ(69,"div",17)(70,"div",18)(71,"label",36),e._uU(72),e.ALo(73,"translate"),e.qZA(),e.TgZ(74,"input",37),e.NdJ("ngModelChange",function(s){return i.labels=s}),e.qZA(),e._UZ(75,"clr-icon",21),e.qZA()()(),e.YNc(76,me,14,7,"div",38),e.YNc(77,Ce,16,9,"div",39),e.TgZ(78,"div",40)(79,"clr-select-container")(80,"label",41),e._uU(81),e.ALo(82,"translate"),e.qZA(),e.TgZ(83,"select",42,43),e.NdJ("ngModelChange",function(s){return i.triggerType=s}),e._UZ(85,"option",11),e.YNc(86,Oe,3,5,"option",12),e.qZA()(),e.YNc(87,Ze,3,0,"clr-tooltip",13),e.qZA(),e.YNc(88,Ee,5,2,"div",38),e.qZA()(),e.YNc(89,ve,7,8,"div",44),e.YNc(90,ye,7,8,"div",44),e.qZA()()()),2&t){const r=e.MAs(14),s=e.MAs(26),d=e.MAs(47),m=e.MAs(61);e.Q6J("clrModalOpen",i.isOpen)("clrModalStaticBackdrop",i.staticBackdrop)("clrModalClosable",i.closable),e.xp6(1),e.Q6J("ngIf",i.isEdit),e.xp6(1),e.Q6J("ngIf",!i.isEdit),e.xp6(9),e.Oqu(e.lcZ(12,51,"P2P_PROVIDER.PROVIDER")),e.xp6(2),e.ekj("clr-error",r.errors&&r.errors.required&&(r.dirty||r.touched)),e.Q6J("disabled",i.loading)("ngModel",i.policy.provider_id),e.xp6(3),e.Q6J("ngForOf",i.providers),e.xp6(1),e.Q6J("ngIf",r.errors&&r.errors.required&&(r.dirty||r.touched)),e.xp6(1),e.Q6J("ngIf",!(i.providers&&i.providers.length)),e.xp6(3),e.Oqu(e.lcZ(22,53,"P2P_PROVIDER.NAME")),e.xp6(2),e.ekj("clr-error",(s.dirty||s.touched)&&s.invalid||i.isNameExisting),e.xp6(2),e.Q6J("disabled",i.loading)("ngModel",i.policy.name),e.xp6(3),e.Q6J("hidden",!i.checkNameOnGoing),e.xp6(1),e.Q6J("ngIf",(s.dirty||s.touched)&&s.invalid||i.isNameExisting),e.xp6(3),e.Oqu(e.lcZ(33,55,"P2P_PROVIDER.DESCRIPTION")),e.xp6(3),e.Q6J("disabled",i.loading)("ngModel",i.policy.description),e.xp6(4),e.Oqu(e.lcZ(40,57,"P2P_PROVIDER.FILTERS")),e.xp6(2),e.ekj("clr-error",d.errors&&d.errors.required&&(d.dirty||d.touched)),e.xp6(3),e.Oqu(e.lcZ(45,59,"P2P_PROVIDER.REPOS")),e.xp6(2),e.Q6J("disabled",i.loading)("ngModel",i.repos),e.xp6(4),e.Oqu(e.lcZ(51,61,"TAG_RETENTION.REP_SEPARATOR")),e.xp6(2),e.Q6J("ngIf",d.errors&&d.errors.required&&(d.dirty||d.touched)),e.xp6(3),e.ekj("clr-error",m.errors&&m.errors.required&&(m.dirty||m.touched)),e.xp6(3),e.Oqu(e.lcZ(59,63,"P2P_PROVIDER.TAGS")),e.xp6(2),e.Q6J("disabled",i.loading)("ngModel",i.tags),e.xp6(4),e.Oqu(e.lcZ(65,65,"P2P_PROVIDER.TAG_SEPARATOR")),e.xp6(2),e.Q6J("ngIf",m.errors&&m.errors.required&&(m.dirty||m.touched)),e.xp6(6),e.Oqu(e.lcZ(73,67,"P2P_PROVIDER.LABELS")),e.xp6(2),e.Q6J("disabled",i.loading)("ngModel",i.labels),e.xp6(2),e.Q6J("ngIf",i.enableContentTrust),e.xp6(1),e.Q6J("ngIf",i.preventVul),e.xp6(4),e.Oqu(e.lcZ(82,69,"P2P_PROVIDER.TRIGGER")),e.xp6(2),e.Q6J("disabled",i.loading)("ngModel",i.triggerType),e.xp6(3),e.Q6J("ngForOf",i.triggers),e.xp6(1),e.Q6J("ngIf",i.showExplainForEventBased()),e.xp6(1),e.Q6J("ngIf",i.showCron()),e.xp6(1),e.Q6J("ngIf",!i.isEdit),e.xp6(1),e.Q6J("ngIf",i.isEdit)}},dependencies:[g.rH,h._Y,h.YN,h.Kr,h.Fj,h.Wl,h.EJ,h.JJ,h.JL,h.Q7,h.c5,h.On,h.F,l.qvL,l.qAN,l.VLi,l.cCV,l.nqY,l.MPb,l.MgK,l.VqA,l.CM6,l.otW,l.dTv,l.Jmj,l.bMv,l.zDF,O.sg,O.O5,M.l,ee.x,u.X$],styles:["[_nghost-%COMP%]  .modal-dialog{width:30rem}.display-none[_ngcontent-%COMP%]{display:none}.icon-tooltip[_ngcontent-%COMP%]{margin-top:4px}.padding-top-3[_ngcontent-%COMP%]{padding-top:3px}.bottom-btn[_ngcontent-%COMP%]{text-align:right}.width-380[_ngcontent-%COMP%]{width:380px}.width-290[_ngcontent-%COMP%]{width:290px}.width-6rem[_ngcontent-%COMP%]{width:6rem!important}.clr-control-label[_ngcontent-%COMP%]{width:8rem}.sub-label[_ngcontent-%COMP%]{display:inline-block;width:90px;font-size:.5417rem;font-weight:400}.sub-text[_ngcontent-%COMP%]{font-size:.5417rem;font-weight:400}.flex[_ngcontent-%COMP%]{display:flex}.margin-top-06[_ngcontent-%COMP%]{margin-top:.6rem}.margin-left-90px[_ngcontent-%COMP%]{margin-left:90px}.opacity-08[_ngcontent-%COMP%]{opacity:.8}.space-between[_ngcontent-%COMP%]{display:flex;font-size:12px;justify-content:space-between}.go-link[_ngcontent-%COMP%]{line-height:1rem;cursor:pointer}.alert-label[_ngcontent-%COMP%]{color:#f9392e}.warning[_ngcontent-%COMP%]{width:320px;line-height:.5rem;white-space:normal;height:auto}.cri-tooltip[_ngcontent-%COMP%]{margin-top:-2px}.cri-tooltip[_ngcontent-%COMP%]:focus{outline:none}.baseline[_ngcontent-%COMP%]{align-items:baseline}.opacity-054[_ngcontent-%COMP%]{opacity:.54}.font-size-12[_ngcontent-%COMP%]{font-size:12px}"]}),c})();var I=p(6266),S=p(3555),Ie=p(3235),Se=p(2553),Le=p(7625);const Re=["confirmationDialogComponent"];function be(n,c){1&n&&(e.TgZ(0,"clr-tooltip-content",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"P2P_PROVIDER.PREHEAT_EXPLAIN")," "))}function Ne(n,c){1&n&&(e.TgZ(0,"span"),e._UZ(1,"clr-icon",38),e.TgZ(2,"span",39),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"WEBHOOK.ENABLED_BUTTON")))}function Me(n,c){1&n&&(e.TgZ(0,"span"),e._UZ(1,"clr-icon",40),e.TgZ(2,"span",39),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"WEBHOOK.DISABLED_BUTTON")))}function De(n,c){if(1&n){const o=e.EpF();e.TgZ(0,"clr-dropdown-menu")(1,"button",29),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.executePolicy())}),e.TgZ(2,"span"),e._UZ(3,"clr-icon",30),e.TgZ(4,"span",31),e._uU(5),e.ALo(6,"translate"),e.qZA()()(),e.TgZ(7,"button",29),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.editPolicy())}),e.TgZ(8,"span"),e._UZ(9,"clr-icon",32),e.TgZ(10,"span",33),e._uU(11),e.ALo(12,"translate"),e.qZA()()(),e.TgZ(13,"button",29),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.switchStatus())}),e.TgZ(14,"span",34),e.YNc(15,Ne,5,3,"span",23),e.YNc(16,Me,5,3,"span",23),e.qZA()(),e._UZ(17,"div",35),e.TgZ(18,"button",29),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.deletePolicy())}),e.TgZ(19,"span"),e._UZ(20,"clr-icon",36),e.TgZ(21,"span",37),e._uU(22),e.ALo(23,"translate"),e.qZA()()()()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("disabled",!(o.selectedRow&&o.selectedRow.enabled)||!o.hasUpdatePermission||o.executing),e.xp6(4),e.Oqu(e.lcZ(6,9,"P2P_PROVIDER.EXECUTE")),e.xp6(2),e.Q6J("disabled",!o.selectedRow||!o.hasUpdatePermission),e.xp6(4),e.Oqu(e.lcZ(12,11,"BUTTON.EDIT")),e.xp6(2),e.Q6J("disabled",!o.selectedRow||!o.hasUpdatePermission),e.xp6(2),e.Q6J("ngIf",o.selectedRow&&!o.selectedRow.enabled),e.xp6(1),e.Q6J("ngIf",!(o.selectedRow&&!o.selectedRow.enabled)),e.xp6(2),e.Q6J("disabled",!o.selectedRow||!o.hasDeletePermission),e.xp6(4),e.Oqu(e.lcZ(23,13,"BUTTON.DELETE"))}}function Ue(n,c){1&n&&(e.TgZ(0,"div",46),e._UZ(1,"clr-icon",47),e.TgZ(2,"span",39),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"WEBHOOK.ENABLED")))}function qe(n,c){1&n&&(e.TgZ(0,"div",46),e._UZ(1,"clr-icon",48),e.TgZ(2,"span",39),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"WEBHOOK.DISABLED")))}function we(n,c){if(1&n&&(e.TgZ(0,"span")(1,"span",49),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",50),e._uU(5),e.qZA()()),2&n){const o=e.oxw().$implicit,t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"P2P_PROVIDER.REPOS")),e.xp6(3),e.hij(": ",t.getValue(o.filters,"repository"),"")}}function ke(n,c){if(1&n&&(e.TgZ(0,"span",51)(1,"span",49),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",50),e._uU(5),e.qZA()()),2&n){const o=e.oxw().$implicit,t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"P2P_PROVIDER.TAGS")),e.xp6(3),e.hij(": ",t.getValue(o.filters,"tag"),"")}}function Je(n,c){if(1&n&&(e.TgZ(0,"span",51)(1,"span",49),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",50),e._uU(5),e.qZA()()),2&n){const o=e.oxw().$implicit,t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"P2P_PROVIDER.LABELS")),e.xp6(3),e.hij(": ",t.getValue(o.filters,"label"),"")}}function je(n,c){1&n&&(e.TgZ(0,"div",52)(1,"span",49),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"P2P_PROVIDER.ONLY_SIGNED")))}function Ve(n,c){if(1&n&&(e.TgZ(0,"div",52)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",50),e._uU(5),e.qZA(),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA()()),2&n){const o=e.oxw().$implicit,t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,3,"P2P_PROVIDER.START_TEXT"),"\xa0"),e.xp6(3),e.Oqu(t.severity_map[t.getValue(o.filters,"vulnerability")]),e.xp6(2),e.hij("\xa0",e.lcZ(8,5,"P2P_PROVIDER.EDN_TEXT"),"")}}function Ye(n,c){if(1&n&&(e.TgZ(0,"clr-signpost-content"),e._uU(1),e.qZA()),2&n){const o=e.oxw(2).$implicit,t=e.oxw();e.xp6(1),e.hij(" ",t.getScheduledCron(o.trigger)," ")}}function Fe(n,c){1&n&&(e.TgZ(0,"clr-signpost"),e.YNc(1,Ye,2,1,"clr-signpost-content",12),e.qZA())}function Qe(n,c){1&n&&(e.TgZ(0,"clr-signpost-content")(1,"div"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.ALo(12,"translate"),e.qZA()()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,4,"P2P_PROVIDER.EVENT_BASED_EXPLAIN_LINE1")," "),e.xp6(3),e.hij(" ",e.lcZ(6,6,"P2P_PROVIDER.EVENT_BASED_EXPLAIN_LINE2")," "),e.xp6(3),e.hij(" ",e.lcZ(9,8,"P2P_PROVIDER.EVENT_BASED_EXPLAIN_LINE3")," "),e.xp6(3),e.hij(" ",e.lcZ(12,10,"P2P_PROVIDER.EVENT_BASED_EXPLAIN_LINE4")," "))}function ze(n,c){1&n&&(e.TgZ(0,"clr-signpost"),e.YNc(1,Qe,13,12,"clr-signpost-content",12),e.qZA())}function He(n,c){if(1&n&&(e.TgZ(0,"clr-dg-row",41)(1,"clr-dg-cell"),e._uU(2),e.qZA(),e.TgZ(3,"clr-dg-cell"),e.YNc(4,Ue,5,3,"div",42),e.YNc(5,qe,5,3,"div",42),e.qZA(),e.TgZ(6,"clr-dg-cell"),e._uU(7),e.qZA(),e.TgZ(8,"clr-dg-cell")(9,"div"),e.YNc(10,we,6,4,"span",23),e.YNc(11,ke,6,4,"span",43),e.YNc(12,Je,6,4,"span",43),e.qZA(),e.YNc(13,je,4,3,"div",44),e.YNc(14,Ve,9,7,"div",44),e.qZA(),e.TgZ(15,"clr-dg-cell",45),e._uU(16),e.ALo(17,"translate"),e.YNc(18,Fe,2,0,"clr-signpost",23),e.YNc(19,ze,2,0,"clr-signpost",23),e.qZA(),e.TgZ(20,"clr-dg-cell"),e._uU(21),e.ALo(22,"harborDatetime"),e.qZA(),e.TgZ(23,"clr-dg-cell"),e._uU(24),e.qZA()()),2&n){const o=c.$implicit,t=e.oxw();e.Q6J("clrDgItem",o),e.xp6(2),e.Oqu(o.name),e.xp6(2),e.Q6J("ngIf",o.enabled),e.xp6(1),e.Q6J("ngIf",!o.enabled),e.xp6(2),e.Oqu(o.provider_name),e.xp6(3),e.Q6J("ngIf",t.getValue(o.filters,"repository")),e.xp6(1),e.Q6J("ngIf",t.getValue(o.filters,"tag")),e.xp6(1),e.Q6J("ngIf",t.getValue(o.filters,"label")),e.xp6(1),e.Q6J("ngIf",t.getValue(o.filters,"signature")),e.xp6(1),e.Q6J("ngIf",t.getValue(o.filters,"vulnerability")),e.xp6(2),e.hij(" ",e.lcZ(17,15,t.getTriggerTypeI18n(o.trigger))," "),e.xp6(2),e.Q6J("ngIf",t.isScheduled(o.trigger)),e.xp6(1),e.Q6J("ngIf",t.isEventBased(o.trigger)),e.xp6(2),e.Oqu(e.xi3(22,17,o.creation_time,"short")),e.xp6(3),e.Oqu(o.description)}}function Ge(n,c){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){e.oxw();const o=e.MAs(53);e.xp6(1),e.lnq("",o.firstItem+1," - ",o.lastItem+1," ",e.lcZ(2,3,"DESTINATION.OF"),"")}}function Be(n,c){1&n&&e._UZ(0,"clr-icon",67)}function Ke(n,c){if(1&n&&(e.TgZ(0,"clr-tooltip-content",68)(1,"span"),e._uU(2),e.qZA()()),2&n){const o=e.oxw().$implicit;e.Q6J("clrPosition","left"),e.xp6(2),e.Oqu(o.status_message)}}function $e(n,c){if(1&n){const o=e.EpF();e.TgZ(0,"clr-dg-row",41)(1,"clr-dg-cell")(2,"a",64),e.NdJ("click",function(){const r=e.CHM(o).$implicit,s=e.oxw(2);return e.KtG(s.goToLink(r.id))}),e._uU(3),e.qZA()(),e.TgZ(4,"clr-dg-cell"),e._uU(5),e.TgZ(6,"clr-tooltip"),e.YNc(7,Be,1,0,"clr-icon",65),e.YNc(8,Ke,3,2,"clr-tooltip-content",66),e.qZA()(),e.TgZ(9,"clr-dg-cell"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"clr-dg-cell"),e._uU(13),e.ALo(14,"harborDatetime"),e.qZA(),e.TgZ(15,"clr-dg-cell"),e._uU(16),e.qZA(),e.TgZ(17,"clr-dg-cell"),e._uU(18),e.ALo(19,"percent"),e.qZA(),e.TgZ(20,"clr-dg-cell"),e._uU(21),e.qZA()()}if(2&n){const o=c.$implicit,t=e.oxw(2);e.Q6J("clrDgItem",o),e.xp6(3),e.Oqu(o.id),e.xp6(2),e.hij(" ",o.status," "),e.xp6(2),e.Q6J("ngIf",o.status_message),e.xp6(3),e.Oqu(e.lcZ(11,9,t.getTriggerTypeI18nForExecution(o.trigger))),e.xp6(3),e.Oqu(e.xi3(14,11,o.start_time,"short")),e.xp6(3),e.Oqu(t.getDuration(o)),e.xp6(2),e.Oqu(e.lcZ(19,14,t.getSuccessRate(o.metrics))),e.xp6(3),e.Oqu(o.vendor_type)}}function Xe(n,c){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){e.oxw();const o=e.MAs(53);e.xp6(1),e.lnq("",o.firstItem+1," - ",o.lastItem+1," ",e.lcZ(2,3,"REPLICATION.OF"),"")}}const We=function(){return[15,25,50]};function et(n,c){if(1&n){const o=e.EpF();e.TgZ(0,"div",53)(1,"h4",54),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"clr-datagrid",55),e.NdJ("clrDgSingleSelectedChange",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.selectedExecutionRow=i)})("clrDgRefresh",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.clrLoadJobs(null,!0,i))}),e.TgZ(5,"clr-dg-action-bar")(6,"div",5)(7,"div",6)(8,"button",56),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.openStopExecutionsDialog())}),e._uU(9),e.ALo(10,"translate"),e.qZA()(),e.TgZ(11,"div",57)(12,"div",58)(13,"select",59),e.NdJ("change",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.selectFilterKey(i))}),e.TgZ(14,"option",60),e._uU(15),e.ALo(16,"lowercase"),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"option",61),e._uU(19),e.ALo(20,"lowercase"),e.ALo(21,"translate"),e.qZA()()(),e.TgZ(22,"hbr-filter",62),e.NdJ("filterEvt",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.doFilter(i))})("openFlag",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.openFilter(i))}),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"span",15)(25,"clr-icon",16),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.refreshJobs())}),e.qZA()()()()(),e.TgZ(26,"clr-dg-column"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"clr-dg-column"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"clr-dg-column"),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"clr-dg-column"),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"clr-dg-column"),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"clr-dg-column"),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"clr-dg-column"),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"clr-dg-placeholder"),e._uU(48),e.ALo(49,"translate"),e.qZA(),e.YNc(50,$e,22,16,"clr-dg-row",19),e.TgZ(51,"clr-dg-footer")(52,"clr-dg-pagination",63,21),e.NdJ("clrDgPageChange",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.currentExecutionPage=i)}),e.TgZ(54,"clr-dg-page-size",22),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.YNc(57,Xe,3,5,"span",23),e._uU(58),e.ALo(59,"translate"),e.qZA()()()()}if(2&n){const o=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,29,"P2P_PROVIDER.EXECUTIONS")),e.xp6(2),e.Q6J("clrDgSingleSelected",o.selectedExecutionRow)("clrDgLoading",o.jobsLoading),e.xp6(4),e.Q6J("disabled",!o.hasUpdatePermission||!o.selectedExecutionRow||o.jobsLoading||o.stopLoading||!o.canStop()),e.xp6(1),e.hij(" ",e.lcZ(10,31,"REPLICATION.STOPJOB")," "),e.xp6(3),e.Q6J("hidden",!o.isOpenFilterTag),e.xp6(3),e.hij(" ",e.lcZ(16,33,e.lcZ(17,35,"P2P_PROVIDER.ID"))," "),e.xp6(4),e.hij(" ",e.lcZ(20,37,e.lcZ(21,39,"REPLICATION.STATUS"))," "),e.xp6(3),e.s9C("filterPlaceholder",e.lcZ(23,41,"REPLICATION.FILTER_EXECUTIONS_PLACEHOLDER")),e.Q6J("currentValue",o.searchString)("withDivider",!0),e.xp6(3),e.Q6J("hidden",o.loading),e.xp6(2),e.Oqu(e.lcZ(28,43,"REPLICATION.ID")),e.xp6(3),e.Oqu(e.lcZ(31,45,"REPLICATION.STATUS")),e.xp6(3),e.Oqu(e.lcZ(34,47,"P2P_PROVIDER.TRIGGER")),e.xp6(3),e.Oqu(e.lcZ(37,49,"REPLICATION.CREATION_TIME")),e.xp6(3),e.Oqu(e.lcZ(40,51,"REPLICATION.DURATION")),e.xp6(3),e.Oqu(e.lcZ(43,53,"REPLICATION.SUCCESS_RATE")),e.xp6(3),e.Oqu(e.lcZ(46,55,"P2P_PROVIDER.PROVIDER_TYPE")),e.xp6(3),e.Oqu(e.lcZ(49,57,"P2P_PROVIDER.JOB_PLACEHOLDER")),e.xp6(2),e.Q6J("ngForOf",o.executionList),e.xp6(2),e.Q6J("clrDgPage",o.currentExecutionPage)("clrDgPageSize",o.pageSize)("clrDgTotalItems",o.totalExecutionCount),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(63,We)),e.xp6(1),e.Oqu(e.lcZ(56,59,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",o.totalExecutionCount),e.xp6(1),e.AsE(" ",o.totalExecutionCount," ",e.lcZ(59,61,"REPLICATION.ITEMS")," ")}}const tt=function(){return[10,25,50]},q=/\/harbor\/projects\/(\d+)\/p2p-provider\/policies/;let it=(()=>{var n;class c{constructor(t,i,r,s,d,m,R,rt,st){this.route=t,this.router=i,this.translate=r,this.p2pProviderService=s,this.messageHandlerService=d,this.userPermissionService=m,this.preheatService=R,this.event=rt,this.scheduleService=st,this.policyList=[],this.providers=[],this.loading=!0,this.hasCreatPermission=!1,this.hasUpdatePermission=!1,this.hasDeletePermission=!1,this.addBtnState=l.xp5.DEFAULT,this.executing=!1,this.isOpenFilterTag=!1,this.jobsLoading=!1,this.stopLoading=!1,this.executionList=[],this.currentExecutionPage=1,this.pageSize=(0,_.tb)(_.V2.P2P_POLICY_COMPONENT_EXECUTIONS),this.totalExecutionCount=0,this.filterKey="id",this._searchSubject=new v.x,this.severity_map=a.Yp,this.hasAddModalInit=!1,this.policyPageSize=(0,_.tb)(_.V2.P2P_POLICY_COMPONENT,10),this.policyPage=1,this.totalPolicy=0,this.paused=!1}ngOnInit(){this.scheduleService.getSchedulePaused({jobType:Ie.O4.ALL}).subscribe(i=>{this.paused=i?.paused}),this.scrollSub||(this.scrollSub=this.event.subscribe(S.n.SCROLL,i=>{i&&q.test(i.url)&&(this.scrollTop=i.scrollTop)})),this.routerSub||(this.routerSub=this.router.events.subscribe(i=>{i instanceof g.m2&&(i&&q.test(i.url)?this.event.publish(S.n.SCROLL_TO_POSITION,this.scrollTop):this.event.publish(S.n.SCROLL_TO_POSITION,0))})),this.subscribeSearch(),this.projectId=+this.route.snapshot.parent.parent.params.id;const t=this.route.snapshot.parent.parent.data;t&&(this.projectName=t.projectResolver.name),this.getPermissions()}ngOnDestroy(){this.routerSub&&(this.routerSub.unsubscribe(),this.routerSub=null),this.scrollSub&&(this.scrollSub.unsubscribe(),this.scrollSub=null),this._searchSubscription&&(this._searchSubscription.unsubscribe(),this._searchSubscription=null),this.clearLoop()}addModalInit(){this.hasAddModalInit=!0}getPermissions(){const t=[];t.push(this.userPermissionService.getPermission(this.projectId,T._W.P2P_PROVIDER.KEY,T._W.P2P_PROVIDER.VALUE.CREATE)),t.push(this.userPermissionService.getPermission(this.projectId,T._W.P2P_PROVIDER.KEY,T._W.P2P_PROVIDER.VALUE.UPDATE)),t.push(this.userPermissionService.getPermission(this.projectId,T._W.P2P_PROVIDER.KEY,T._W.P2P_PROVIDER.VALUE.DELETE)),this.addBtnState=l.xp5.LOADING,(0,x.D)(...t).subscribe(i=>{[this.hasCreatPermission,this.hasUpdatePermission,this.hasDeletePermission]=i,this.addBtnState=l.xp5.SUCCESS,this.hasCreatPermission&&this.getProviders()},i=>{this.messageHandlerService.error(i),this.addBtnState=l.xp5.ERROR})}getProviders(){this.preheatService.ListProvidersUnderProject({projectName:this.projectName}).subscribe(t=>{t&&t.length&&(this.providers=t.filter(i=>i.enabled))})}refresh(){this.selectedRow=null,this.policyPage=1,this.totalPolicy=0,this.getPolicies(this.state)}getPolicies(t){let i,r;t&&(this.state=t),t&&t.page&&(this.policyPageSize=t.page.size,(0,_.Pe)(_.V2.P2P_POLICY_COMPONENT,this.policyPageSize)),t&&t.filters&&t.filters.length&&(i=encodeURIComponent(`${t.filters[0].property}=~${t.filters[0].value}`)),r=t&&t.sort&&t.sort.by?(0,_.td)(t):"-creation_time",this.loading=!0,this.preheatService.ListPoliciesResponse({projectName:this.projectName,sort:r,q:i,page:this.policyPage,pageSize:this.policyPageSize}).pipe((0,f.x)(()=>this.loading=!1)).subscribe(s=>{if(s.headers){let d=s.headers.get("X-Total-Count");d&&(this.totalPolicy=parseInt(d,0))}this.policyList=s.body||[]},s=>{this.messageHandlerService.handleError(s)})}switchStatus(){let t="";this.translate.get(this.selectedRow.enabled?"P2P_PROVIDER.DISABLED_POLICY_SUMMARY":"P2P_PROVIDER.ENABLED_POLICY_SUMMARY",{name:this.selectedRow.name}).subscribe(i=>{t=i;let r=new I.c(this.selectedRow.enabled?"P2P_PROVIDER.DISABLED_POLICY_TITLE":"P2P_PROVIDER.ENABLED_POLICY_TITLE",t,"",{},18,this.selectedRow.enabled?5:4);this.confirmationDialogComponent.open(r)})}confirmSwitch(t){if(t&&19===t.source&&1===t.state){this.stopLoading=!0;const i=(0,_.d9)(this.selectedExecutionRow);i.status=a.r9.STOPPED,this.preheatService.StopExecution({projectName:this.projectName,preheatPolicyName:this.selectedRow.name,executionId:this.selectedExecutionRow.id,execution:i}).pipe((0,f.x)(()=>this.executing=!1)).subscribe(r=>{this.messageHandlerService.showSuccess("P2P_PROVIDER.STOP_SUCCESSFULLY")},r=>{this.messageHandlerService.error(r)})}if(t&&20===t.source&&1===t.state&&(this.executing=!0,this.preheatService.ManualPreheat({projectName:this.projectName,preheatPolicyName:this.selectedRow.name,policy:this.selectedRow}).pipe((0,f.x)(()=>this.executing=!1)).subscribe(i=>{this.messageHandlerService.showSuccess("P2P_PROVIDER.EXECUTE_SUCCESSFULLY"),this.selectedRow&&this.refreshJobs()},i=>{this.messageHandlerService.error(i)})),t&&18===t.source&&1===t.state&&"{}"===JSON.stringify(t.data)&&this.preheatService.UpdatePolicy({projectName:this.projectName,preheatPolicyName:this.selectedRow.name,policy:Object.assign({},this.selectedRow,{enabled:!this.selectedRow.enabled})}).subscribe(i=>{this.messageHandlerService.showSuccess("P2P_PROVIDER.UPDATED_SUCCESSFULLY"),this.refresh()},i=>{this.messageHandlerService.handleError(i)}),t&&21===t.source&&1===t.state){const i=[];i.push(this.preheatService.DeletePolicy({projectName:this.projectName,preheatPolicyName:this.selectedRow.name})),(0,x.D)(...i).subscribe(r=>{this.messageHandlerService.showSuccess("P2P_PROVIDER.DELETE_SUCCESSFULLY"),this.refresh()},r=>{this.messageHandlerService.handleError(r)})}}newPolicy(){this.addP2pPolicyComponent.isOpen=!0,this.addP2pPolicyComponent.isEdit=!1,this.addP2pPolicyComponent.resetForAdd()}editPolicy(){if(this.selectedRow){this.addP2pPolicyComponent.repos=null,this.addP2pPolicyComponent.tags=null,this.addP2pPolicyComponent.labels=null,this.addP2pPolicyComponent.isOpen=!0,this.addP2pPolicyComponent.isEdit=!0,this.addP2pPolicyComponent.isNameExisting=!1,this.addP2pPolicyComponent.inlineAlert.close(),this.addP2pPolicyComponent.policy=(0,_.d9)(this.selectedRow);const t=JSON.parse(this.selectedRow.filters);t&&t.length&&t.forEach(r=>{if(r.type===a.kQ.REPOS&&r.value){let s=r.value;if(/^{\S+}$/.test(s))return s.slice(1,s.length-1);this.addP2pPolicyComponent.repos=s}if(r.type===a.kQ.TAG&&r.value){let s=r.value;if(/^{\S+}$/.test(s))return s.slice(1,s.length-1);this.addP2pPolicyComponent.tags=s}if(r.type===a.kQ.LABEL&&r.value){let s=r.value;if(/^{\S+}$/.test(s))return s.slice(1,s.length-1);this.addP2pPolicyComponent.labels=s}});const i=JSON.parse(this.selectedRow.trigger);i&&(this.addP2pPolicyComponent.triggerType=i.type,this.addP2pPolicyComponent.cron=i.trigger_setting.cron),this.addP2pPolicyComponent.currentForm.reset({provider:this.addP2pPolicyComponent.policy.provider_id,name:this.addP2pPolicyComponent.policy.name,description:this.addP2pPolicyComponent.policy.description,repo:this.addP2pPolicyComponent.repos,tag:this.addP2pPolicyComponent.tags,onlySignedImages:this.addP2pPolicyComponent.enableContentTrust,severity:this.addP2pPolicyComponent.severity,label:this.addP2pPolicyComponent.labels,triggerType:this.addP2pPolicyComponent.triggerType}),this.addP2pPolicyComponent.originPolicyForEdit=(0,_.d9)(this.selectedRow),this.addP2pPolicyComponent.originReposForEdit=this.addP2pPolicyComponent.repos,this.addP2pPolicyComponent.originTagsForEdit=this.addP2pPolicyComponent.tags,this.addP2pPolicyComponent.originOnlySignedImagesForEdit=this.addP2pPolicyComponent.onlySignedImages,this.addP2pPolicyComponent.originSeverityForEdit=this.addP2pPolicyComponent.severity,this.addP2pPolicyComponent.originLabelsForEdit=this.addP2pPolicyComponent.labels,this.addP2pPolicyComponent.originTriggerTypeForEdit=this.addP2pPolicyComponent.triggerType,this.addP2pPolicyComponent.originCronForEdit=this.addP2pPolicyComponent.cron}}deletePolicy(){const t=[];t.push(this.selectedRow.name);let i="";this.translate.get("P2P_PROVIDER.DELETE_POLICY_SUMMARY",{names:t.join(",")}).subscribe(s=>i=s);const r=new I.c("SCANNER.CONFIRM_DELETION",i,t.join(","),this.selectedRow,21,2);this.confirmationDialogComponent.open(r)}executePolicy(){if(this.selectedRow&&this.selectedRow.enabled){const t=new I.c("P2P_PROVIDER.EXECUTE_TITLE","P2P_PROVIDER.EXECUTE_SUMMARY",this.selectedRow.name,this.selectedRow,20,0);this.confirmationDialogComponent.open(t)}}success(t){let i;i=t?"P2P_PROVIDER.ADDED_SUCCESS":"P2P_PROVIDER.UPDATED_SUCCESS",this.messageHandlerService.showSuccess(i),this.refresh()}clrLoadJobs(t,i,r){if(this.selectedRow){let s;r&&r.page&&(this.pageSize=r.page.size,(0,_.Pe)(_.V2.P2P_POLICY_COMPONENT_EXECUTIONS,this.pageSize)),i&&setTimeout(()=>{this.jobsLoading=!0}),this.searchString&&(s=encodeURIComponent(`${this.filterKey}=~${this.searchString}`)),this.preheatService.ListExecutionsResponse({projectName:this.projectName,preheatPolicyName:t?t.name:this.selectedRow.name,page:this.currentExecutionPage,pageSize:this.pageSize,q:s}).pipe((0,f.x)(()=>this.jobsLoading=!1)).subscribe(d=>{if(d.headers){let m=d.headers.get("X-Total-Count");m&&(this.totalExecutionCount=parseInt(m,0))}this.executionList=d.body,this.setLoop()},d=>{this.messageHandlerService.handleError(d)})}}refreshJobs(t){this.executionList=[],this.currentExecutionPage=1,this.totalExecutionCount=0,this.filterKey="id",this.searchString=null,this.clrLoadJobs(t,!0)}openStopExecutionsDialog(){if(this.selectedExecutionRow){const t=new I.c("P2P_PROVIDER.STOP_TITLE","P2P_PROVIDER.STOP_SUMMARY",this.selectedExecutionRow.id+"",this.selectedExecutionRow,19,0);this.confirmationDialogComponent.open(t)}}goToLink(t){this.router.navigate(["harbor","projects",`${this.projectId}`,"p2p-provider",`${this.selectedRow.name}`,"executions",`${t}`,"tasks"])}getTriggerTypeI18n(t){return JSON.parse(t).type?this.paused&&JSON.parse(t).type===a.pA.SCHEDULED?a.E3[a.pA.SCHEDULED_PAUSED]:a.E3[JSON.parse(t).type]:a.E3[a.pA.MANUAL]}getTriggerTypeI18nForExecution(t){return t&&a.E3[t]?a.E3[t]:t}isScheduled(t){return JSON.parse(t).type===a.pA.SCHEDULED}isEventBased(t){return JSON.parse(t).type===a.pA.EVENT_BASED}getScheduledCron(t){return JSON.parse(t).trigger_setting.cron}getDuration(t){return this.p2pProviderService.getDuration(t.start_time,t.end_time)}getValue(t,i){const r=JSON.parse(t);if(r&&r.length)for(let s=0;s<r.length;s++)if(r[s].type===i&&r[s].value){let d=r[s].value;return/^{\S+}$/.test(d)?d.slice(1,d.length-1):d}return""}getSuccessRate(t){return t&&t.task_count&&t.success_task_count?t.success_task_count/t.task_count:0}selectFilterKey(t){this.filterKey=t.target.value}openFilter(t){this.isOpenFilterTag=t}doFilter(t){this.searchString=t,t.trim()?this._searchSubject.next(t.trim()):this.clrLoadJobs(null,!0)}subscribeSearch(){this._searchSubscription||(this._searchSubscription=this._searchSubject.pipe((0,E.b)(500),(0,A.w)(t=>{let i;return this.jobsLoading=!0,this.searchString&&(i=encodeURIComponent(`${this.filterKey}=~${t}`)),this.preheatService.ListExecutionsResponse({projectName:this.projectName,preheatPolicyName:this.selectedRow.name,page:1,pageSize:this.pageSize,q:i}).pipe((0,f.x)(()=>this.jobsLoading=!1))})).subscribe(t=>{if(t.headers){let i=t.headers.get("x-total-count");i&&(this.totalExecutionCount=parseInt(i,0))}this.executionList=t.body,this.setLoop()}))}canStop(){return this.selectedExecutionRow&&this.p2pProviderService.willChangStatus(this.selectedExecutionRow.status)}clearLoop(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}setLoop(){if(this.clearLoop(),this.executionList&&this.executionList.length)for(let t=0;t<this.executionList.length;t++)this.p2pProviderService.willChangStatus(this.executionList[t].status)&&(this.timeout||(this.timeout=setTimeout(()=>{this.clrLoadJobs(null,!1)},a.X8)))}}return(n=c).\u0275fac=function(t){return new(t||n)(e.Y36(g.gz),e.Y36(g.F0),e.Y36(u.sK),e.Y36(a.YQ),e.Y36(P.d),e.Y36(T.Hx),e.Y36(C.L),e.Y36(S.P),e.Y36(Se.u))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(t,i){if(1&t&&(e.Gf(U,5),e.Gf(Re,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.addP2pPolicyComponent=r.first),e.iGM(r=e.CRH())&&(i.confirmationDialogComponent=r.first)}},decls:64,vars:57,consts:[[1,"row"],[1,"mt-1"],["clrTooltipTrigger","","shape","info-circle","size","24",1,"color-57"],["clrPosition","top-right","clrSize","lg",4,"clrIfOpen"],[3,"clrDgLoading","clrDgSingleSelected","clrDgRefresh","clrDgSingleSelectedChange"],[1,"clr-row"],[1,"clr-col-7"],["id","new-policy","type","button",1,"btn","btn-secondary",3,"disabled","clrLoading","click"],["shape","plus","size","16"],["clrDropdownTrigger","",1,"btn","btn-link",3,"clrCloseMenuOnItemClick"],["id","action-policy"],["shape","caret down",1,"clr-icon"],[4,"clrIfOpen"],[1,"clr-col-5"],[1,"action-head-pos"],[1,"refresh-btn"],["shape","refresh",3,"hidden","click"],[3,"clrDgField"],[3,"clrDgSortBy"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgPageSize","clrDgPage","clrDgTotalItems","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[4,"ngIf"],["class","col-lg-12 col-md-12 col-sm-12 col-xs-12",4,"ngIf"],[3,"providers","hasInit","notify"],[3,"confirmAction"],["confirmationDialogComponent",""],["clrPosition","top-right","clrSize","lg"],["clrDropdownItem","",1,"btn","btn-secondary",3,"disabled","click"],["size","16","shape","play",1,"margin-top-0"],["id","execute-policy",1,"margin-left-5px"],["size","16","shape","pencil",1,"margin-top-0"],["id","edit-policy",1,"margin-left-5px"],["id","toggle-policy"],[1,"dropdown-divider"],["size","16","shape","times",1,"margin-top-0"],["id","delete-policy",1,"margin-left-5px"],["size","16","shape","success-standard",1,"margin-top-2"],[1,"margin-left-5px"],["size","16","shape","ban",1,"margin-top-2"],[3,"clrDgItem"],["class","icon-wrap",4,"ngIf"],["class","margin-left-10px",4,"ngIf"],["class","margin-top-5px",4,"ngIf"],[1,"no-wrapper"],[1,"icon-wrap"],["shape","check-circle","size","20",1,"is-success","enabled-icon"],["shape","exclamation-triangle","size","20",1,"is-warning"],[1,"filter-title"],[1,"opacity08"],[1,"margin-left-10px"],[1,"margin-top-5px"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[1,"mt-2"],[3,"clrDgSingleSelected","clrDgLoading","clrDgSingleSelectedChange","clrDgRefresh"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],[1,"clr-col-5","flex-end"],[1,"select","filter-tag","clr-select-wrapper",3,"hidden"],["id","selectKey",3,"change"],["value","id"],["value","status"],["id","filter-executions",3,"currentValue","withDivider","filterPlaceholder","filterEvt","openFlag"],[3,"clrDgPage","clrDgPageSize","clrDgTotalItems","clrDgPageChange"],["href","javascript:void(0)",3,"click"],["clrTooltipTrigger","","shape","info-circle","size","20",4,"ngIf"],["clrSize","md",3,"clrPosition",4,"clrIfOpen"],["clrTooltipTrigger","","shape","info-circle","size","20"],["clrSize","md",3,"clrPosition"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h4",1)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"clr-tooltip"),e._UZ(6,"clr-icon",2),e.YNc(7,be,3,3,"clr-tooltip-content",3),e.qZA()(),e.TgZ(8,"clr-datagrid",4),e.NdJ("clrDgRefresh",function(s){return i.getPolicies(s)})("clrDgSingleSelectedChange",function(s){return i.refreshJobs(s)})("clrDgSingleSelectedChange",function(s){return i.selectedRow=s}),e.TgZ(9,"clr-dg-action-bar")(10,"div",5)(11,"div",6)(12,"button",7),e.NdJ("click",function(){return i.newPolicy()}),e._UZ(13,"clr-icon",8),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"clr-dropdown",9)(17,"span",10),e._uU(18),e.ALo(19,"translate"),e._UZ(20,"clr-icon",11),e.qZA(),e.YNc(21,De,24,15,"clr-dropdown-menu",12),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14)(24,"span",15)(25,"clr-icon",16),e.NdJ("click",function(){return i.refresh()}),e.qZA()()()()()(),e.TgZ(26,"clr-dg-column",17),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"clr-dg-column"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"clr-dg-column"),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"clr-dg-column"),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"clr-dg-column"),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"clr-dg-column",18),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"clr-dg-column"),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"clr-dg-placeholder"),e._uU(48),e.ALo(49,"translate"),e.qZA(),e.YNc(50,He,25,20,"clr-dg-row",19),e.TgZ(51,"clr-dg-footer")(52,"clr-dg-pagination",20,21),e.NdJ("clrDgPageChange",function(s){return i.policyPage=s}),e.TgZ(54,"clr-dg-page-size",22),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.YNc(57,Ge,3,5,"span",23),e._uU(58),e.ALo(59,"translate"),e.qZA()()()(),e.YNc(60,et,60,64,"div",24),e.TgZ(61,"add-p2p-policy",25),e.NdJ("hasInit",function(){return i.addModalInit()})("notify",function(s){return i.success(s)}),e.qZA(),e.TgZ(62,"confirmation-dialog",26,27),e.NdJ("confirmAction",function(s){return i.confirmSwitch(s)}),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,30,"P2P_PROVIDER.POLICIES")),e.xp6(5),e.Q6J("clrDgLoading",i.loading)("clrDgSingleSelected",i.selectedRow),e.xp6(4),e.Q6J("disabled",!i.hasCreatPermission||!i.hasAddModalInit)("clrLoading",i.addBtnState),e.xp6(2),e.hij(" ",e.lcZ(15,32,"P2P_PROVIDER.NEW_POLICY")," "),e.xp6(2),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(2),e.hij("",e.lcZ(19,34,"MEMBER.ACTION")," "),e.xp6(7),e.Q6J("hidden",i.loading),e.xp6(1),e.Q6J("clrDgField","name"),e.xp6(1),e.Oqu(e.lcZ(28,36,"P2P_PROVIDER.NAME")),e.xp6(3),e.Oqu(e.lcZ(31,38,"P2P_PROVIDER.ENABLED")),e.xp6(3),e.Oqu(e.lcZ(34,40,"P2P_PROVIDER.PROVIDER")),e.xp6(3),e.Oqu(e.lcZ(37,42,"P2P_PROVIDER.FILTERS")),e.xp6(3),e.Oqu(e.lcZ(40,44,"P2P_PROVIDER.TRIGGER")),e.xp6(2),e.Q6J("clrDgSortBy","creation_time"),e.xp6(1),e.Oqu(e.lcZ(43,46,"P2P_PROVIDER.CREATED")),e.xp6(3),e.Oqu(e.lcZ(46,48,"P2P_PROVIDER.DESCRIPTION")),e.xp6(3),e.hij(" ",e.lcZ(49,50,"P2P_PROVIDER.NO_POLICY")," "),e.xp6(2),e.Q6J("ngForOf",i.policyList),e.xp6(2),e.Q6J("clrDgPageSize",i.policyPageSize)("clrDgPage",i.policyPage)("clrDgTotalItems",i.totalPolicy),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(56,tt)),e.xp6(1),e.Oqu(e.lcZ(56,52,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",i.totalPolicy),e.xp6(1),e.AsE(" ",i.totalPolicy," ",e.lcZ(59,54,"DESTINATION.ITEMS")," "),e.xp6(2),e.Q6J("ngIf",i.selectedRow),e.xp6(1),e.Q6J("providers",i.providers))},dependencies:[h.YN,h.Kr,l.C9t,l.Gwl,l.fv_,l.m4W,l.dRQ,l.YYR,l.Ltv,l.F7K,l.Z4N,l.jND,l.KHL,l.PDs,l.Gcc,l.dml,l.Nh1,l.K8c,l.qvL,l.cCV,l.nqY,l.MPb,l.f_W,l.zwp,l.ZUS,l.lU3,l.EuU,l.hQ,l.Jmj,l.bMv,l.zDF,O.sg,O.O5,b.z,Le.z,U,u.X$,O.i8,O.Zx,N.Z],styles:[".action-head-pos[_ngcontent-%COMP%]{padding-right:18px;height:100%;display:flex;justify-content:flex-end;align-items:center}.icon-wrap[_ngcontent-%COMP%]{display:flex;align-items:center;height:20px}.cell[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%}.margin-left-5px[_ngcontent-%COMP%]{margin-left:5px}.margin-left-10px[_ngcontent-%COMP%]{margin-left:10px}.flex-end[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:flex-end;padding-right:1.5rem}.refresh-btn[_ngcontent-%COMP%]{margin-top:6px;cursor:pointer}.filter-tag[_ngcontent-%COMP%]{margin-top:7px}.filter-title[_ngcontent-%COMP%]{font-weight:400}.margin-top-5px[_ngcontent-%COMP%]{margin-top:5px}.opacity08[_ngcontent-%COMP%]{opacity:.8}.no-wrapper[_ngcontent-%COMP%]{white-space:nowrap}"]}),c})();var w=p(8778);const nt=[{path:"policies",component:it,data:{reuse:!0,routeConfigId:w.j.P2P_POLICIES_PAGE}},{path:":preheatPolicyName/executions/:executionId/tasks",component:B,data:{routeConfigId:w.j.P2P_TASKS_PAGE}},{path:"",redirectTo:"policies",pathMatch:"full"}];let ot=(()=>{var n;class c{}return(n=c).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[a.YQ],imports:[g.Bz.forChild(nt),L.m]}),c})()},927:(k,y,p)=>{p.d(y,{z:()=>v});var g=p(5879),L=p(8645),E=p(3620),A=p(6223),f=p(6814),_=p(8280);const T=["inputElement"];function a(x,l){1&x&&g._UZ(0,"span",4)}let v=(()=>{var x;class l{set filterPlaceholder(u){this.placeHolder=u}constructor(u){this.cd=u,this.placeHolder="",this.filterTerms=new L.x,this.isExpanded=!1,this.filterEvt=new g.vpe,this.openFlag=new g.vpe,this.readonly=null,this.expandMode=!1,this.withDivider=!1}ngOnInit(){this.filterTerms.pipe((0,E.b)(500)).subscribe(u=>{this.filterEvt.emit(u)})}valueChange(){this.filterTerms.next(this.currentValue&&this.currentValue.trim())}inputFocus(){this.openFlag.emit(this.isExpanded)}onClick(){this.expandMode||(this.isExpanded=!this.isExpanded,this.isExpanded&&(this.cd.detectChanges(),this.inputElement.nativeElement.focus()),this.openFlag.emit(this.isExpanded))}get isShowSearchBox(){return this.expandMode||!this.expandMode&&this.isExpanded}}return(x=l).\u0275fac=function(u){return new(u||x)(g.Y36(g.sBO))},x.\u0275cmp=g.Xpm({type:x,selectors:[["hbr-filter"]],viewQuery:function(u,P){if(1&u&&g.Gf(T,5),2&u){let C;g.iGM(C=g.CRH())&&(P.inputElement=C.first)}},inputs:{readonly:"readonly",currentValue:"currentValue",filterPlaceholder:"filterPlaceholder",expandMode:"expandMode",withDivider:"withDivider",width:"width"},outputs:{filterEvt:"filterEvt",openFlag:"openFlag"},decls:5,vars:9,consts:[["shape","search","size","20",1,"search-btn",3,"click"],["type","text","autofocus","",1,"filter-input","clr-input",3,"hidden","placeholder","ngModel","keyup","focus","ngModelChange"],["inputElement",""],["class","filter-divider",4,"ngIf"],[1,"filter-divider"]],template:function(u,P){1&u&&(g.TgZ(0,"span")(1,"clr-icon",0),g.NdJ("click",function(){return P.onClick()}),g.qZA(),g.TgZ(2,"input",1,2),g.NdJ("keyup",function(){return P.valueChange()})("focus",function(){return P.inputFocus()})("ngModelChange",function(h){return P.currentValue=h}),g.qZA(),g.YNc(4,a,1,0,"span",3),g.qZA()),2&u&&(g.xp6(1),g.ekj("filter-icon",P.isShowSearchBox),g.xp6(1),g.Udp("width",P.width,"px"),g.s9C("placeholder",P.placeHolder),g.Q6J("hidden",!P.isShowSearchBox)("ngModel",P.currentValue),g.uIk("readOnly",P.readonly),g.xp6(2),g.Q6J("ngIf",P.withDivider))},dependencies:[A.Fj,A.JJ,A.On,f.O5,_.qvL],styles:[".filter-icon[_ngcontent-%COMP%]{position:relative;right:-20px}.filter-divider[_ngcontent-%COMP%]{display:inline-block;height:16px;width:1px;padding-top:12px;padding-bottom:12px;position:relative;top:9px;margin-right:6px;margin-left:6px}.search-btn[_ngcontent-%COMP%]{cursor:pointer}.search-btn[_ngcontent-%COMP%]:hover{color:#007cbb}.filter-input[_ngcontent-%COMP%]{padding-left:24px}"]}),l})()}}]);